

  <!DOCTYPE html>
  <html lang="zh-CN" data-default-color-scheme=&#34;dark&#34; >
  <style>
    .text1
    {
    text-shadow: 0px 0px 2px #f2f3f2;
    }
    </style>

  

<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/null">
  <link rel="icon" type="image/png" href="/null">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>COBOL考古（六） - whale3070&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"192.168.126.129","root":"/","version":"1.8.7","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 7.3.0"></head>


    <body>
      <header style="height: 70vh;">
        <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>InfoSec learning</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/search/">
                <i class="iconfont icon-search"></i>
                搜索
              </a>
            </li>
          
        
        
        
          
        
      </ul>
    </div>
  </div>
</nav>

          <div class="banner" id="banner" false
            style="background: url('/img/default.png') no-repeat center center;
              background-size: cover;">
              <div class="full-bg-img">
                <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
                  <div class="page-header text-center fade-in-up">
                    <span class="h2 text1" id="subtitle" title="COBOL考古（六）">
                      
                        COBOL考古（六）
                      
                    </span>
        
                    
                      <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-09-30 21:20" pubdate>
        2023年9月30日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.8k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      42
       分钟
    </span>
  

  
  
</div>

                    
                  </div>
                    
                  </div>
                  
                </div>
              </div>
          </div>
      </header>

      <main>
        
          

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" data-pagefind-body>
            <!-- SEO header -->
            <h1 style="display: none">COBOL考古（六）</h1>
            
            <div class="markdown-body">
              <h2 id="实验-使用-Zowe-CLI-和自动化"><a href="#实验-使用-Zowe-CLI-和自动化" class="headerlink" title="实验 - 使用 Zowe CLI 和自动化"></a>实验 - 使用 Zowe CLI 和自动化</h2><p>在这个实验中，您将使用 Zowe CLI 自动提交 JCL 以编译、链接和运行 COBOL 程序，并下载输出。如果您还没有安装 Zowe CLI，请参考“安装 Zowe CLI 和插件”部分进行安装。在开发自动化之前，我们将首先以交互方式使用 Zowe CLI。</p>
<h3 id="Zowe-CLI-交互式使用"><a href="#Zowe-CLI-交互式使用" class="headerlink" title="Zowe CLI - 交互式使用"></a>Zowe CLI - 交互式使用</h3><p>在本节中，我们将使用 Zowe CLI 以交互方式查看数据集成员、提交作业和查看输出汇总。</p>
<ol>
<li><p>在 VS Code 中，打开集成终端（终端 -&gt; 新建终端）。在终端中，输入 <code>zowe --version</code> 以确认 Zowe CLI 已安装，如下图所示。如果尚未安装，请参考“安装 Zowe CLI 和插件”部分。还请注意，默认选择的 shell 是 <code>cmd</code>。建议为此实验选择默认 shell 为 <code>bash</code> 或 <code>cmd</code>。</p>
<p><img src="/2023/09/30/11967/zowe-cli-version.png" srcset="/img/loading.gif" alt="图 26.  在 VS Code 集成终端中执行 &#96;zowe --version&#96; 命令"></p>
</li>
<li><p>为了使 Zowe CLI 能够与 z&#x2F;OSMF 交互，CLI 必须知道连接详细信息，如主机、端口、用户名、密码等。虽然您可以在每个命令中输入这些信息，但 Zowe 提供了在配置文件中存储这些信息的功能。</p>
<p>如果您在第一个实验中进行了配置，那么您将拥有一个包含您的团队配置文件的文件夹。请确保您的终端位于该位置，并执行以下命令。</p>
<figure class="highlight lua"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs lua">zowe <span class="hljs-built_in">config</span> list <span class="hljs-comment">--locations</span><br></code></pre></div></td></tr></table></figure></li>
<li><p>请执行以下命令，确认您可以连接到 z&#x2F;OSMF：</p>
<figure class="highlight smali"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs smali">zowe zosmf<span class="hljs-built_in"> check </span>status<br></code></pre></div></td></tr></table></figure>
</li>
<li><p>通过执行类似以下命令的命令列出您的 ID 下的数据集（请参考下图中的示例输出）：</p>
<figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">zowe <span class="hljs-keyword">files</span> <span class="hljs-keyword">list</span> <span class="hljs-keyword">ds</span> <span class="hljs-string">&quot;Z99998.*&quot;</span><br></code></pre></div></td></tr></table></figure>

<p>您还可以通过执行类似以下命令的命令列出分区数据集中的所有成员（请参考下图中的示例输出）：</p>
<figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">zowe <span class="hljs-keyword">files</span> <span class="hljs-keyword">list</span> <span class="hljs-keyword">am</span> <span class="hljs-string">&quot;Z99998.CBL&quot;</span><br></code></pre></div></td></tr></table></figure>

<p><img src="/2023/09/30/11967/zowe-files-list-ds-and-am-commands.png" srcset="/img/loading.gif"><br><em>Figure  28.  zowe files list ds 和 am 命令</em></p>
</li>
<li><p>接下来，我们将下载我们的 COBOL 和 JCL 数据集成员到本地计算机。在终端中，执行类似以下命令的命令：</p>
<figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">zowe <span class="hljs-keyword">files</span> download <span class="hljs-keyword">am</span> <span class="hljs-string">&quot;Z99998.CBL&quot;</span> -<span class="hljs-keyword">e</span> <span class="hljs-string">&quot;.cbl&quot;</span><br>zowe <span class="hljs-keyword">files</span> download <span class="hljs-keyword">am</span> <span class="hljs-string">&quot;Z99998.JCL&quot;</span> -<span class="hljs-keyword">e</span> <span class="hljs-string">&quot;.jcl&quot;</span><br></code></pre></div></td></tr></table></figure>
<p>下图显示了一个已完成的示例：</p>
<p><img src="/2023/09/30/11967/zowe-files-download-am.png" srcset="/img/loading.gif"></p>
<p><em>图 29. 使用 CLI 下载和查看数据集成员</em></p>
</li>
<li><p>接下来，我们将提交位于成员 <code>Z99998.JCL(HELLO)</code> 中的作业。要提交作业、等待其完成并查看所有输出，请执行以下命令：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">zowe <span class="hljs-keyword">jobs </span><span class="hljs-keyword">submit </span>ds <span class="hljs-string">&quot;Z99998.JCL(HELLO)&quot;</span> --vasc<br></code></pre></div></td></tr></table></figure>

<p>我们也可以分步执行这一步骤，以获取特定输出。请参考接下来的示例，其中包含即将使用的命令。要提交作业并等待其进入 OUTPUT 状态，请执行以下命令：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">zowe <span class="hljs-keyword">jobs </span><span class="hljs-keyword">submit </span>ds <span class="hljs-string">&quot;Z99998.JCL(HELLO)&quot;</span> --wfo<br></code></pre></div></td></tr></table></figure>

<p>要列出与此作业 ID 相关的输出，请执行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">zowe <span class="hljs-built_in">jobs</span> list sfbj JOB04064<br></code></pre></div></td></tr></table></figure>

<p>其中，<code>JOB04064</code> 是从前一个命令中返回的值。</p>
<p>要查看特定的输出文件（COBRUN:SYSOUT），请执行以下命令：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">zowe <span class="hljs-keyword">jobs </span>view sfbi <span class="hljs-keyword">JOB04064 </span><span class="hljs-number">105</span><br></code></pre></div></td></tr></table></figure>

<p>其中，<code>JOB04064</code> 和 <code>105</code> 是从前面的命令中获取的值。<br><img src="/2023/09/30/11967/zowe-jobs-submit-ds-and-view-spool-output.png" srcset="/img/loading.gif"></p>
<p><em>图 30. 提交作业，等待完成，然后列出作业的输出，查看特定输出文件</em></p>
<p>如果需要，您还可以使用以下命令轻松提交作业、等待其完成并下载输出内容（请参考下图中的已完成状态）：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">zowe <span class="hljs-keyword">jobs </span><span class="hljs-keyword">submit </span>ds <span class="hljs-string">&quot;Z99998.JCL(HELLO)&quot;</span> -d .<br></code></pre></div></td></tr></table></figure>

<p><img src="/2023/09/30/11967/zowe-jobs-submit-ds-and-download-spool-output.png" srcset="/img/loading.gif"></p>
<p><em>图 31. 提交作业，等待完成，下载并查看输出</em></p>
<p>Zowe CLI 考虑了脚本编写。例如，您可以使用 <code>--rfj</code> 标志以 JSON 格式接收输出，以便轻松解析。请参考下图的示例。</p>
<p><img src="/2023/09/30/11967/zowe-jobs-submit-ds-rfj.png" srcset="/img/loading.gif"></p>
<p><em>图 32. <code>--rfj</code> 标志允许轻松进行编程式使用</em></p>
</li>
</ol>
<h3 id="Zowe-CLI-编程式使用"><a href="#Zowe-CLI-编程式使用" class="headerlink" title="Zowe CLI - 编程式使用"></a>Zowe CLI - 编程式使用</h3><p>在本节中，我们将以编程方式利用 Zowe CLI 来自动化提交用于编译、链接和运行 COBOL 程序的 JCL，并下载输出。一旦您将内容保存到本地，您就可以使用任意数量的分布式脚本和测试工具来消除手动查看输出内容本身的需要。在 Mainframe 中，我们通常使用 REXX Exec、CLIST 等进行自动化，但今天我们将使用 CLI 和分布式工具。</p>
<ol>
<li><p>由于我们已经安装了 Node 和 npm，请让我们为自动化创建一个 Node 项目。要在项目的文件夹中初始化项目，请在项目的文件夹中运行 <code>npm init</code> 命令并按照提示操作。您可以通过按回车键接受默认值。只需更改描述和作者字段。请参考下图。请注意，要使用前面部分提到的团队配置文件，此项目必须是 <strong>LearnCOBOL</strong> 文件夹的子目录。</p>
<p><img src="/2023/09/30/11967/npm-init-example.png" srcset="/img/loading.gif"></p>
<p><em>图 33. 使用 <code>npm init</code> 创建项目的 <code>package.json</code></em></p>
</li>
<li><p>现在我们有了 <code>package.json</code>，只需用一个 <code>clg</code> 脚本替换 <code>test</code> 脚本，该脚本运行以下 zowe 命令（请将 <code>Z99998</code> 替换为您的高级限定符）：</p>
<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">zowe jobs submit ds &#x27;Z<span class="hljs-number">9999</span>8.JCL(HELLO)&#x27; <span class="hljs-punctuation">-</span>d .<br></code></pre></div></td></tr></table></figure>

<p>您可以随意命名脚本。我之所以建议 <code>clg</code>，是因为 <code>IGYWCLG</code> 过程中的 <code>CLG</code>（这是 JCL 利用的内容）代表编译、链接和运行。现在，只需在终端中输入 <code>npm run clg</code>，即可利用自动化来编译、链接和运行 COBOL 程序，并下载输出进行审查。完成的 <code>package.json</code> 和命令执行示例如下图所示。</p>
<p><img src="/2023/09/30/11967/npm-run-clg.png" srcset="/img/loading.gif"></p>
<p><em>图 34. 最终的 <code>package.json</code> 和 <code>npm run clg</code> 执行</em></p>
</li>
<li><p>如果您更喜欢图形触发器，可以像下图所示使用 VS Code。基本上，CLI 使您能够快速构建自己的 z&#x2F;OS 自定义任务按钮。您还可以调用脚本而不是单个命令，以适应更复杂的情况。</p>
<p><img src="/2023/09/30/11967/npm-run-clg-button.png" srcset="/img/loading.gif"></p>
<p><em>图 35. 通过按钮触发的 <code>clg</code> 任务</em></p>
</li>
</ol>
<h1 id="数据分区"><a href="#数据分区" class="headerlink" title="数据分区"></a>数据分区</h1><p>了解 COBOL 变量以及变量的程序处理对于有效学习 COBOL 语言至关重要。一位经验丰富的 COBOL 程序员必须掌握 COBOL 变量的特性以及使用本章介绍的变量进行的程序处理。其目标是向读者介绍 COBOL 变量的基础知识，同时让读者了解许多高级 COBOL 变量选项。</p>
<p>在本章之后，有一个实验室可以用来编译和执行本章后面提供的 COBOL 源代码。成功编译和执行一个提供的程序后，可以编译第二个提供的 COBOL 程序，该程序有一个小改动。第二个程序中嵌入了一个错误，在编译时会失败。编译失败是一个机会，可以识别与 COMPUTE 语句的操作相关的 PICTURE 子句数据类型的重要性以及如何解决错误。</p>
<ul>
<li><p><strong>变量&#x2F;数据项</strong></p>
<ul>
<li><strong>变量&#x2F;数据项名称限制和数据类型</strong></li>
</ul>
</li>
<li><p><strong>PICTURE 子句</strong></p>
<ul>
<li><p><strong>PIC 子句符号和数据类型</strong></p>
</li>
<li><p><strong>编写 COBOL 变量&#x2F;数据项名称</strong></p>
</li>
<li><p><strong>PICTURE 子句字符串表示</strong></p>
</li>
</ul>
</li>
<li><p><strong>文字</strong></p>
<ul>
<li><p><strong>比喻常数</strong></p>
</li>
<li><p><strong>数据关系</strong></p>
</li>
<li><p><strong>数据级别</strong></p>
</li>
</ul>
</li>
<li><p><strong>MOVE 和 COMPUTE</strong></p>
</li>
<li><p><strong>实验室</strong></p>
</li>
</ul>
<h2 id="变量-数据项"><a href="#变量-数据项" class="headerlink" title="变量&#x2F;数据项"></a>变量&#x2F;数据项</h2><p>COBOL 变量，也称为数据项，是一个名称，由 COBOL 程序员选择。所选名称被编码为保存数据的变量，其中数据值可以变化，因此使用通用术语“变量”。COBOL 变量名称也称为“数据名称”。COBOL 变量名称具有限制。</p>
<h3 id="变量-数据项名称限制和数据类型"><a href="#变量-数据项名称限制和数据类型" class="headerlink" title="变量&#x2F;数据项名称限制和数据类型"></a>变量&#x2F;数据项名称限制和数据类型</h3><p>COBOL 变量名称的限制或规则列表如下：</p>
<ul>
<li><p>不能是 COBOL 保留字。</p>
</li>
<li><p>不能包含空格作为名称的一部分。</p>
</li>
<li><p>名称包含字母（A-Z）、数字（0-9）、下划线（_）和连字符（-）。</p>
</li>
<li><p>最大长度为 30 个字符。</p>
</li>
<li><p>连字符不能出现在第一个或最后一个字符。</p>
</li>
<li><p>下划线不能出现在第一个字符。</p>
</li>
</ul>
<p><strong>注意</strong>：COBOL 保留字的完整列表可以在 Enterprise COBOL 语言参考的附录 E 中找到。</p>
<p>当将 COBOL 源代码编译为可执行程序时，COBOL 编译器会期望具有属性的命名 COBOL 变量，例如长度和数据类型。在程序执行期间，该变量表示处理内存的定义区域，其中内存位置具有最大长度和指定的数据类型。</p>
<p>以下是最常见的 COBOL 数据类型列表：</p>
<ul>
<li><p>数字（0-9）</p>
</li>
<li><p>字母（A-Z）、（a-z）或空格</p>
</li>
<li><p>字母数字混合类型</p>
</li>
</ul>
<h2 id="PICTURE-子句"><a href="#PICTURE-子句" class="headerlink" title="PICTURE 子句"></a>PICTURE 子句</h2><p>COBOL 保留字 PICTURE（PIC）确定了由程序员选择的变量名称的长度和数据类型。由 PIC 描述的数据类型通常称为图片子句或 pic 子句。一些简单的图片子句如下：</p>
<ul>
<li><p>PIC 9 - 单个数字值，长度为一</p>
</li>
<li><p>PIC 9(4) - 四个数字值，长度为四</p>
</li>
<li><p>PIC X - 单个字母数字（字符）值，长度为一</p>
</li>
<li><p>PIC X(4) - 四个字母数字值，长度为四</p>
</li>
</ul>
<h3 id="PIC-子句符号和数据类型"><a href="#PIC-子句符号和数据类型" class="headerlink" title="PIC 子句符号和数据类型"></a>PIC 子句符号和数据类型</h3><p>图片子句的最大长度取决于数据类型和编译器选项。PIC 保留字除了数字型（PIC 9）和字母数字型（PIC X）之外，还有许多其他数据类型。例如，仅包含字母的数据类型被定义为 PIC A。其他 PIC 子句符号包括：</p>
<p><code>B E G N P S U V Z 0 / + - , . * CR DB cs</code></p>
<p>其中 cs 是任何有效的货币符号，例如美元符号（$）。</p>
<p>所有 PIC 子句符号的详细信息可以在<a target="_blank" rel="noopener" href="https://publibfp.dhe.ibm.com/epubs/pdf/igy6lr40.pdf">Enterprise COBOL for z&#x2F;OS 语言参考手册</a>中找到。</p>
<h3 id="编写-COBOL-变量-数据项名称"><a href="#编写-COBOL-变量-数据项名称" class="headerlink" title="编写 COBOL 变量&#x2F;数据项名称"></a>编写 COBOL 变量&#x2F;数据项名称</h3><p>PIC 子句描述了变量&#x2F;数据项名称的数据类型。编写变量&#x2F;数据项名称是在 DATA DIVISION 中完成的。用于描述变量&#x2F;数据项名称的 COBOL 代码使用层次编号和图片子句。</p>
<ul>
<li><p>层次编号 - 记录中字段的层次结构。</p>
</li>
<li><p>变量名称&#x2F;数据项名称 - 为要在程序中引用的每个字段分配一个名称，并且在程序内必须是唯一的。</p>
</li>
<li><p>图片子句 - 用于数据类型检查。</p>
</li>
</ul>
<p>下面的图 1 是 COBOL 层次编号示例，带有相应的变量&#x2F;数据项名称和图片子句。</p>
<h3 id="PICTURE-子句字符串表示"><a href="#PICTURE-子句字符串表示" class="headerlink" title="PICTURE 子句字符串表示"></a>PICTURE 子句字符串表示</h3><p>某些 PIC 子句符号只能在图片子句字符串中出现一次，而其他符号可以出现多次。例如：</p>
<ul>
<li><p>用于保存值 1123.45 的 PIC 子句编码如下，其中 V 代表小数点位置。</p>
<p> <code>PIC 9(4)V99</code></p>
</li>
<li><p>用于值如 $1,123.45 的 PIC 子句编码如下：</p>
<p> <code>PIC $9,999V99</code></p>
</li>
</ul>
<h2 id="文字"><a href="#文字" class="headerlink" title="文字"></a>文字</h2><p>COBOL 文字是常量数据值，意味着其值不会像变量一样更改。COBOL 语句 <code>DISPLAY &quot;HELLO WORLD!&quot;,</code> 是 COBOL 保留字 <code>DISPLAY</code> 后跟文字 <code>HELLO WORLD!</code>。 </p>
<h3 id="比喻常数"><a href="#比喻常数" class="headerlink" title="比喻常数"></a>比喻常数</h3><p>比喻常数是指定特定常数值的保留字。比喻常数的示例包括：</p>
<ul>
<li><p>ZERO, ZEROS, ZEROES</p>
</li>
<li><p>SPACE, SPACES</p>
</li>
<li><p>HIGH-VALUE, HIGH-VALUES</p>
</li>
<li><p>LOW-VALUE, LOW-VALUES</p>
</li>
<li><p>QUOTE, QUOTES</p>
</li>
<li><p>NULL, NULLS</p>
</li>
</ul>
<h3 id="数据关系"><a href="#数据关系" class="headerlink" title="数据关系"></a>数据关系</h3><p>在程序中使用的所有数据之间的关系在数据部分（DATA DIVISION）中定义，通过一种层次编号和层次数的系统。层次指示符和其描述性条目标识程序中的每个文件。层次指示符表示与其关联的任何数据层次结构的最高级别。层次编号和其描述性条目指示特定数据的属性。层次编号可用于描述数据层次结构；它们可以指示此数据具有特殊目的。</p>
<h4 id="层次编号"><a href="#层次编号" class="headerlink" title="层次编号"></a>层次编号</h4><p>结构化的层次编号层次关系适用于所有 DATA DIVISION 部分。图 1 显示了程序员选择的层次编号、变量名称和 PIC 子句在文件部分中的层次关系，其中 “01 PRINT-REC” 引用以下 “05” 级变量组，”01 ACCT-FIELDS” 引用以下 “05” 级变量组。请注意，05 级 CLIENT-ADDR 进一步细分为几个 10 级名称。引用名称 CLIENT-ADDR 的 COBOL 代码包括 10 级名称。</p>
<p><img src="/2023/09/30/11967/image107.png" srcset="/img/loading.gif"></p>
<p><em>图 1. 层次编号层次关系</em></p>
<h3 id="数据层次"><a href="#数据层次" class="headerlink" title="数据层次"></a>数据层次</h3><p>在定义记录之后，可以将其细分以提供更详细的数据引用，如图 1 所示。层次编号是一个 01 到 49 之间的一位或两位整数，或者是三个特殊层次编号之一：66、77 或 88，其中变量名称被分配了与 01-49 层次编号不同的属性。组项内部层次编号之间的关系定义了该组内数据的层次结构。组项包括从其后跟随的所有组和基本项，直到遇到小于或等于该组层次编号的层次编号。基本项是不能进一步细分的项。这些项具有 PIC 子句，因为它们为该项保留存储空间。</p>
<h2 id="MOVE-和-COMPUTE"><a href="#MOVE-和-COMPUTE" class="headerlink" title="MOVE 和 COMPUTE"></a>MOVE 和 COMPUTE</h2><p>MOVE 和 COMPUTE 保留字语句改变变量名称的值。图 2 中显示的每个 MOVE 都导致字面值存储在 77 级变量名称中。在图 2 中还显示了 COMPUTE 语句，它将 <code>HOURS * RATE</code> 的值存储在 <code>GROSS-PAY</code> 中。所有三个变量名称都使用 PIC 9 赋予了数值值数据类型，这是 COMPUTE 语句操作所必需的。</p>
<p><img src="/2023/09/30/11967/image108.png" srcset="/img/loading.gif"></p>
<p><em>图 2. MOVE 和 COMPUTE 示例</em></p>
<h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p><strong>注意</strong>：加载此实验的所有部分可能需要几秒钟的时间。如果文件未加载，请在悬停在部分栏上时点击刷新按钮。</p>
<ol>
<li><p>查看 ‘id’.CBL 数据集中 PAYROL00 COBOL 源代码成员。</p>
</li>
<li><p>从 id.JCL 下拉列表中提交 JCL 成员 PAYROL00。这是 id.JCL(PAYROL00) 编译并成功执行 PAYROL00 程序的地方。</p>
</li>
</ol>
<p><img src="/2023/09/30/11967/image113.png" srcset="/img/loading.gif"></p>
<p><em>图 3. 提交 PAYROL00 作业</em></p>
<p><strong>注意</strong>: 如果在提交作业后收到此错误消息：<br><img src="/2023/09/30/11967/image114.png" srcset="/img/loading.gif"><br>那是因为您是从 .CBL 数据集提交的作业，而不是 .JCL 数据集。</p>
<ol start="3">
<li>查看 PAYROL00 作业输出的编译和执行，参见图 4。</li>
</ol>
<p><img src="/2023/09/30/11967/image116.png" srcset="/img/loading.gif"></p>
<p><em>图 4. PAYROL00 输出</em></p>
<ol start="4">
<li><p>接下来，查看 id.CBL 数据集中 PAYROL0X COBOL 源代码成员。</p>
</li>
<li><p>查看并提交 id.JCL 下拉列表中的 JCL 成员 PAYROL0X。这是 id.JCL(PAYROL0X) 编译并执行 PAYROL0X 程序的地方。</p>
</li>
<li><p>查看 PAYROLL0X 作业输出的编译，注意没有执行输出。</p>
<p>您是否注意到此编译与图 5 中显示的先前作业编译之间的差异？</p>
</li>
</ol>
<p><img src="/2023/09/30/11967/image117.png" srcset="/img/loading.gif"></p>
<p><em>图 5. 比较作业编译</em></p>
<p>它们之间的不同之处在于与每个作业输出关联的返回&#x2F;完成代码，如上所示，位于 JOBS 部分中的作业输出名称旁边，或者位于编译输出的末尾，格式为 0Return code ##。返回代码为 12 意味着存在错误，但我们如何知道错误是什么呢？继续了解吧！</p>
<ol start="7">
<li><p>在作业输出中找到编译错误 IGYPA3146-S，如图 6 所示。</p>
<p><img src="/2023/09/30/11967/image121.png" srcset="/img/loading.gif"></p>
<p><em>图 6. IGYPA3146-S 错误信息</em></p>
<p>请注意，此行告诉您要关注 GROSS-PAY 图片子句，以识别问题。使用这些信息，修改 PAYROL0X COBOL 源代码以修复错误。确保您正在编辑正确的代码。</p>
</li>
<li><p>在修改后，重新提交 PAYROL0X JCL 以验证问题是否已被识别和修正，结果是成功的编译和执行，返回代码为零，如图 7 所示。</p>
<p><img src="/2023/09/30/11967/image124.png" srcset="/img/loading.gif"></p>
<p><em>图 7. 比较返回代码</em></p>
</li>
</ol>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/program/">program</a>
                    
                  </div>
                
              </div>
              
                
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/10/01/4826.html">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">COBOL考古（七）</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/30/26278.html">
                        <span class="hidden-mobile">COBOL考古（五）</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


            

                
                  <a id="scroll-top-button" href="#" role="button">
                    <i class="iconfont icon-arrowup" aria-hidden="true"></i>
                  </a>
                  

                    

                          
      </main>

      <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://whale3070.github.io/" target="_blank" rel="nofollow noopener"><span>Whale3070</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
  <script src="/pagefind/pagefind-ui.js"></script>
  <style>
    /* 搜索框配色适配 */
    #search { margin-top: 2rem; }
    [data-user-color-scheme='dark'] .pagefind-ui {
      --pagefind-ui-primary: #eeeeee;
      --pagefind-ui-text: #eeeeee;
      --pagefind-ui-background: #151515;
      --pagefind-ui-border: #333;
    }
  </style>
    </body>

  </html>