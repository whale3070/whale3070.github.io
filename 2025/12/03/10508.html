

  <!DOCTYPE html>
  <html lang="zh-CN" data-default-color-scheme=&#34;dark&#34; >
  <style>
    .text1
    {
    text-shadow: 0px 0px 2px #f2f3f2;
    }
    </style>

  <script>
    // 强制内网 IP 识别为安全上下文
    if (window.location.hostname !== 'localhost' && window.location.protocol === 'http:') {
        // 尝试手动映射 crypto 属性
        if (!window.crypto.subtle && window.crypto.webkitSubtle) {
            window.crypto.subtle = window.crypto.webkitSubtle;
        }
    }
    
    // 终极补丁：如果还是没有 subtle，则创建一个占位符避免报错
    // 提示：这通常能解决加载报错，但如果插件强依赖原生加密，建议执行下面的“降级”预判
    if (!window.isSecureContext) {
        console.warn('当前环境非安全上下文，正在尝试兼容内网加密解密...');
    }
</script>


<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/null">
  <link rel="icon" type="image/png" href="/null">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>javascript3 - whale3070&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.4.0/styles/github-gist.min.css" />
    
  

  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"whale3070.github.io","root":"/","version":"1.8.7","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":false,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 7.3.0"></head>


    <body>
      <header style="height: 70vh;">
        <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>InfoSec learning</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/search/">
                <i class="iconfont icon-search"></i>
                搜索
              </a>
            </li>
          
        
        
        
          
        
      </ul>
    </div>
  </div>
</nav>

          <div class="banner" id="banner" false
            style="background: url('/img/default.png') no-repeat center center;
              background-size: cover;">
              <div class="full-bg-img">
                <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
                  <div class="page-header text-center fade-in-up">
                    <span class="h2 text1" id="subtitle" title="javascript3">
                      
                        javascript3
                      
                    </span>
        
                    
                      <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2025-12-03 08:48" pubdate>
        2025年12月3日 早上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      9k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      112
       分钟
    </span>
  

  
  
</div>

                    
                  </div>
                    
                  </div>
                  
                </div>
              </div>
          </div>
      </header>

      <main>
        
          

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" data-pagefind-body>
            <!-- SEO header -->
            <h1 style="display: none">javascript3</h1>
            
            <div class="markdown-body">
              <h1 id="现在我学完了xxx…"><a href="#现在我学完了xxx…" class="headerlink" title="现在我学完了xxx…"></a>现在我学完了xxx…</h1><p>现在我学完了<a target="_blank" rel="noopener" href="https://cryptozombies.io/zh/course%E7%9A%84Solidity">https://cryptozombies.io/zh/course的Solidity</a>: Beginner to Intermediate Smart Contracts，了解了Chainlink 和预言机，NEO, zkSync，tronBox, truffle以及js基础语法。我学了truffle, remix, fountry，hardhat，但我发现这些工具很复杂，我用remix多一点，另外三个只是在linux虚拟机中安装好了。现在我了解了做solidity开发，编写以及测试solidity智能合约一样重要。现在我还不会使用ether.js，现在发现文档好多，学习遇到了困难，不知道下一步该干什么</p>
<h2 id="ChatGPT的回答"><a href="#ChatGPT的回答" class="headerlink" title="ChatGPT的回答"></a>ChatGPT的回答</h2><p>首先，恭喜你已经掌握了 <strong>Solidity</strong> 基础，学习了区块链开发的重要工具和概念！你已经学了很多内容，的确有时候工具和框架太多、文档也多，可能让你感到有点迷茫。以下是我对你当前学习阶段的建议，帮助你梳理思路，并明确下一步该做什么。</p>
<h3 id="1-巩固和实践-Solidity"><a href="#1-巩固和实践-Solidity" class="headerlink" title="1. 巩固和实践 Solidity"></a>1. <strong>巩固和实践 Solidity</strong></h3><p>你已经学过了 <strong>Solidity</strong>，接下来最重要的是通过实践来巩固知识。可以通过以下方式进行：</p>
<ul>
<li><p><strong>编写和部署合约</strong>：</p>
<ul>
<li>继续在 <strong>Remix</strong> 上进行智能合约的编写、测试和部署。可以尝试一些更复杂的合约，比如实现一个去中心化的代币（ERC-20）或者拍卖合约等。</li>
<li>通过 Remix 部署到以太坊测试网（如 Rinkeby、Ropsten）进行实战练习。你可以通过测试网获取免费的测试ETH，用来模拟真实的部署环境。</li>
</ul>
</li>
<li><p><strong>写更多智能合约</strong>：</p>
<ul>
<li>尝试解决实际问题，比如创建一个去中心化应用（DApp）或者智能合约应用程序，应用你学到的合约和工具。</li>
<li>持续调试、修改合约，理解 Solidity 中的细节，尤其是一些难点（如 gas 优化、安全性等）。</li>
</ul>
</li>
</ul>
<h3 id="2-Ether-js-学习："><a href="#2-Ether-js-学习：" class="headerlink" title="2. Ether.js 学习："></a>2. <strong>Ether.js 学习</strong>：</h3><p>你提到目前对 <strong>Ether.js</strong> 感到困惑，文档确实多，但它是与 Solidity 智能合约交互的关键工具之一，理解如何在前端应用中使用它将对你非常有帮助。为了避免文档的困扰，建议采取以下步骤：</p>
<ul>
<li><p><strong>学习 Ether.js 的基本操作</strong>：</p>
<ul>
<li>在前端项目中使用 Ether.js 与智能合约进行交互。</li>
<li>学习如何通过 <strong>Ether.js</strong> 连接到以太坊节点、发送交易、读取区块链数据以及与部署在区块链上的智能合约进行交互。</li>
<li>通过官方文档和教程（例如 <a target="_blank" rel="noopener" href="https://docs.ethers.io/v5/">Ether.js 文档</a>）进行系统学习，但可以先从简单的案例入手。</li>
</ul>
</li>
<li><p><strong>实践</strong>：</p>
<ul>
<li>尝试编写一个小的前端应用，使用 Ether.js 连接到你的 Solidity 合约。这能帮助你深入理解如何与智能合约交互。</li>
<li>比如创建一个简单的 DApp，用户可以通过界面与合约进行交互，执行例如转账、查询余额等操作。</li>
</ul>
</li>
</ul>
<h3 id="3-加深对-Truffle、Hardhat、Foundry-的理解："><a href="#3-加深对-Truffle、Hardhat、Foundry-的理解：" class="headerlink" title="3. 加深对 Truffle、Hardhat、Foundry 的理解："></a>3. <strong>加深对 Truffle、Hardhat、Foundry 的理解</strong>：</h3><p>虽然你已经安装了这些开发工具，但如果还没有深入使用，建议逐步掌握它们的核心功能。它们是 Solidity 开发中非常强大的工具，可以帮助你进行智能合约的测试、部署和调试。</p>
<ul>
<li><p><strong>Truffle</strong>：</p>
<ul>
<li>继续尝试使用 Truffle 来创建和测试智能合约，使用它提供的命令行工具来部署合约和执行脚本。你可以参考 Truffle 的 <a target="_blank" rel="noopener" href="https://www.trufflesuite.com/docs">官方文档</a> 来了解如何创建项目、测试合约等。</li>
</ul>
</li>
<li><p><strong>Hardhat</strong>：</p>
<ul>
<li>Hardhat 是一个更现代的开发框架，你可以使用它编写和调试智能合约。它还支持更强大的测试功能和与链的交互。可以从 Hardhat 的 <a target="_blank" rel="noopener" href="https://hardhat.org/getting-started/">官方文档</a> 学习如何设置 Hardhat 环境，编写测试脚本。</li>
</ul>
</li>
<li><p><strong>Foundry</strong>：</p>
<ul>
<li>Foundry 是一个性能非常好的 Solidity 开发框架。可以通过 <a target="_blank" rel="noopener" href="https://book.getfoundry.sh/">Foundry 文档</a> 来了解如何使用 Foundry 创建合约、运行测试等。</li>
</ul>
</li>
</ul>
<h3 id="4-学习测试合约："><a href="#4-学习测试合约：" class="headerlink" title="4. 学习测试合约："></a>4. <strong>学习测试合约</strong>：</h3><p>你提到过 <strong>测试合约</strong> 也很重要，正确的测试能够帮助你验证合约的正确性，并在开发过程中避免错误。</p>
<ul>
<li><p><strong>Truffle 和 Hardhat 测试</strong>：</p>
<ul>
<li>你可以通过 Truffle 或 Hardhat 编写 JavaScript 测试脚本，模拟和验证合约的功能。例如，使用 Mocha 或 Chai 测试框架对合约进行单元测试。</li>
</ul>
</li>
<li><p><strong>编写单元测试</strong>：</p>
<ul>
<li>学习如何使用这些工具编写单元测试，验证合约是否按预期执行。重点关注合约的功能、边界情况、权限控制、攻击防范等。</li>
</ul>
</li>
</ul>
<h3 id="5-加入开发者社区和项目实践："><a href="#5-加入开发者社区和项目实践：" class="headerlink" title="5. 加入开发者社区和项目实践："></a>5. <strong>加入开发者社区和项目实践</strong>：</h3><p>加入一些开发者社区或参与开源项目，可以帮助你在实际项目中积累经验，解决实际问题。</p>
<ul>
<li><p><strong>GitHub 开源项目</strong>：</p>
<ul>
<li>在 GitHub 上查找和参与开源的 Solidity 项目，学习别人的代码，贡献自己的代码。</li>
</ul>
</li>
<li><p><strong>参加开发者竞赛</strong>：</p>
<ul>
<li>参加一些区块链开发比赛，如 Ethereum 或其他平台举办的黑客松活动，这能帮助你在实战中学习并解决问题。</li>
</ul>
</li>
</ul>
<h3 id="6-小结："><a href="#6-小结：" class="headerlink" title="6. 小结："></a>6. <strong>小结</strong>：</h3><ol>
<li><strong>继续深入 Solidity 和 Ether.js</strong>，通过实际项目巩固技能。</li>
<li><strong>理解并使用开发工具</strong>（Truffle、Hardhat、Foundry）进行合约的编写、测试和部署。</li>
<li><strong>多做练习，参与开源项目</strong>，与社区互动，解决实际问题。</li>
</ol>
<p>学习 Solidity 和区块链开发是一项长期的过程，切忌急于求成。保持持续的实践和学习，你会逐渐掌握这些工具和技术的，并能够开发出强大且安全的智能合约和去中心化应用。</p>
<h2 id="豆包的回答"><a href="#豆包的回答" class="headerlink" title="豆包的回答"></a>豆包的回答</h2><p>结合你的基础（Solidity 初中级、Remix 熟练、工具已安装、JS 基础）和痛点（工具复杂、Ethers.js 文档多、迷茫下一步），核心思路是：<strong>简化工具栈+聚焦“Ethers.js 实操+合约测试”+ 落地小项目</strong>，不用贪多，先把“合约编写→Ethers.js 交互→测试”的闭环跑通，再逐步拓展。</p>
<p>以下是「3 阶段落地式学习路径」，每个阶段都有明确目标、具体任务，且完全衔接你已有的知识：</p>
<h3 id="一、第一阶段：简化工具，聚焦-Ethers-js-核心（3-5-天）"><a href="#一、第一阶段：简化工具，聚焦-Ethers-js-核心（3-5-天）" class="headerlink" title="一、第一阶段：简化工具，聚焦 Ethers.js 核心（3-5 天）"></a>一、第一阶段：简化工具，聚焦 Ethers.js 核心（3-5 天）</h3><p>目标：<strong>不用啃完 Ethers.js 文档，只学“能和你 Solid 合约交互”的核心功能</strong>，配合 Hardhat （不用深钻工具本身，只当“辅助环境”），快速实现“合约调用”。</p>
<p>核心动作 1：固定工具栈（弃用冗余工具，减少认知负担）<br>不用纠结 Truffle、TronBox，暂时只留 3 个核心工具，形成闭环：</p>
<ul>
<li>「合约编写&#x2F;编译」：Remix（你最熟悉，不用换）</li>
<li>「Ethers.js 运行环境」：Hardhat（已安装，自带 Ethers.js，不用额外配置）</li>
<li>「链环境」：Hardhat 本地节点（不用装 Ganache，Hardhat 内置本地测试网，零配置）</li>
</ul>
<p>核心动作 2：用 Hardhat 搭最小 Ethers.js 交互环境（1 天搞定）<br>Hardhat 能帮你自动管理合约 ABI、启动本地节点，避免手动复制 ABI、配置 RPC 地址的麻烦，专注 Ethers.js 代码：</p>
<h4 id="步骤-1：初始化-Hardhat-项目（已安装可跳过）"><a href="#步骤-1：初始化-Hardhat-项目（已安装可跳过）" class="headerlink" title="步骤 1：初始化 Hardhat 项目（已安装可跳过）"></a>步骤 1：初始化 Hardhat 项目（已安装可跳过）</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> solidity-ethers-demo &amp;&amp; <span class="hljs-built_in">cd</span> solidity-ethers-demo<br>npm init -y<br>proxychains npm install --save-dev hardhat ethers<br><span class="hljs-comment">#用proxychains是因为国内可能有墙，导致无法安装</span><br></code></pre></div></td></tr></table></figure>

<h4 id="步骤-2：把你熟悉的合约（比如-CryptoZombies-僵尸合约）复制到-Hardhat"><a href="#步骤-2：把你熟悉的合约（比如-CryptoZombies-僵尸合约）复制到-Hardhat" class="headerlink" title="步骤 2：把你熟悉的合约（比如 CryptoZombies 僵尸合约）复制到 Hardhat"></a>步骤 2：把你熟悉的合约（比如 CryptoZombies 僵尸合约）复制到 Hardhat</h4><ol>
<li>在项目中创建文件夹：<code>contracts/Zombie.sol</code></li>
<li>把 Remix 里写好的僵尸合约（或任意你熟悉的合约，比如简单 ERC20）复制进去（确保合约能编译通过）</li>
</ol>
<h4 id="步骤-3：编译合约，生成-ABI（Hardhat-自动处理）"><a href="#步骤-3：编译合约，生成-ABI（Hardhat-自动处理）" class="headerlink" title="步骤 3：编译合约，生成 ABI（Hardhat 自动处理）"></a>步骤 3：编译合约，生成 ABI（Hardhat 自动处理）</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat compile  <span class="hljs-comment"># 编译后会生成 artifacts/ 文件夹，里面有 ABI</span><br></code></pre></div></td></tr></table></figure>

<h4 id="步骤-4：启动-Hardhat-本地节点（模拟区块链）"><a href="#步骤-4：启动-Hardhat-本地节点（模拟区块链）" class="headerlink" title="步骤 4：启动 Hardhat 本地节点（模拟区块链）"></a>步骤 4：启动 Hardhat 本地节点（模拟区块链）</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat node  <span class="hljs-comment"># 会启动本地节点，生成 20 个测试账户（地址+私钥+1000 ETH），记住第一个账户地址</span><br></code></pre></div></td></tr></table></figure>

<p>核心动作 3：写 3 个极简 Ethers.js 脚本（练会核心交互）<br>在项目中创建 <code>scripts/</code> 文件夹，写 3 个脚本，覆盖“读合约→写合约→交易处理”，每个脚本都能直接运行，看到结果：</p>
<p>脚本 1：读合约（无交易费，熟悉 Provider+Contract）<br>比如读僵尸合约的“某个地址的僵尸数量”：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// scripts/read-contract.js</span><br><span class="hljs-keyword">const</span> hre = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;hardhat&quot;</span>);<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 1. Hardhat 自动获取合约（不用手动写 ABI 和地址，编译后直接用）</span><br>  <span class="hljs-keyword">const</span> <span class="hljs-title class_">ZombieContract</span> = <span class="hljs-keyword">await</span> hre.<span class="hljs-property">ethers</span>.<span class="hljs-title function_">getContractFactory</span>(<span class="hljs-string">&quot;Zombie&quot;</span>);<br>  <span class="hljs-keyword">const</span> zombieContract = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ZombieContract</span>.<span class="hljs-title function_">deploy</span>(); <span class="hljs-comment">// 部署到本地节点（或用已部署的地址）</span><br>  <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">deployed</span>();<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;合约部署地址：&quot;</span>, zombieContract.<span class="hljs-property">address</span>);<br><br>  <span class="hljs-comment">// 2. 调用读函数（比如 CryptoZombies 的 getZombiesByOwner）</span><br>  <span class="hljs-keyword">const</span> ownerAddress = <span class="hljs-string">&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb9226&quot;</span>; <span class="hljs-comment">// Hardhat 本地节点第一个账户</span><br>  <span class="hljs-keyword">const</span> zombieCount = <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">getZombiesByOwner</span>(ownerAddress);<br>  <br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;ownerAddress&#125;</span> 的僵尸数量：`</span>, zombieCount.<span class="hljs-title function_">toString</span>());<br>&#125;<br><br><span class="hljs-title function_">main</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>  process.<span class="hljs-property">exitCode</span> = <span class="hljs-number">1</span>;<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<p>运行脚本（新开终端，本地节点保持运行）：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat run scripts/read-contract.js --network localhost<br></code></pre></div></td></tr></table></figure>


<p>脚本 2：写合约（调用写函数，熟悉 Signer+交易发送）<br>比如调用僵尸合约的“创建僵尸”函数（写操作，需要签名）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// scripts/write-contract.js</span><br><span class="hljs-keyword">const</span> hre = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;hardhat&quot;</span>);<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 1. 获取合约+签名者（Hardhat 自动用本地节点的第一个账户当签名者）</span><br>  <span class="hljs-keyword">const</span> <span class="hljs-title class_">ZombieContract</span> = <span class="hljs-keyword">await</span> hre.<span class="hljs-property">ethers</span>.<span class="hljs-title function_">getContractFactory</span>(<span class="hljs-string">&quot;Zombie&quot;</span>);<br>  <span class="hljs-keyword">const</span> zombieContract = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ZombieContract</span>.<span class="hljs-title function_">deploy</span>();<br>  <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">deployed</span>();<br><br>  <span class="hljs-comment">// 2. 调用写函数（比如 createRandomZombie，需要传参数）</span><br>  <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">createRandomZombie</span>(<span class="hljs-string">&quot;我的第一个僵尸&quot;</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;交易哈希：&quot;</span>, tx.<span class="hljs-property">hash</span>);<br><br>  <span class="hljs-comment">// 3. 等待交易上链</span><br>  <span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>();<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;僵尸创建成功！&quot;</span>);<br><br>  <span class="hljs-comment">// 4. 验证结果（读函数查数量）</span><br>  <span class="hljs-keyword">const</span> ownerAddress = <span class="hljs-string">&quot;0xf39Fd6e51aad88F6F4ce6aB8827279cffFb9226&quot;</span>;<br>  <span class="hljs-keyword">const</span> zombieCount = <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">getZombiesByOwner</span>(ownerAddress);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`当前僵尸数量：`</span>, zombieCount.<span class="hljs-title function_">toString</span>());<br>&#125;<br><br><span class="hljs-title function_">main</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>  process.<span class="hljs-property">exitCode</span> = <span class="hljs-number">1</span>;<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<p>运行脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat run scripts/write-contract.js --network localhost<br></code></pre></div></td></tr></table></figure>


<p>脚本 3：处理交易回执+事件（实战高频）<br>CryptoZombies 合约有 <code>NewZombie</code> 事件，我们可以从交易回执中提取僵尸 ID：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// scripts/handle-tx-event.js</span><br><span class="hljs-keyword">const</span> hre = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;hardhat&quot;</span>);<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-title class_">ZombieContract</span> = <span class="hljs-keyword">await</span> hre.<span class="hljs-property">ethers</span>.<span class="hljs-title function_">getContractFactory</span>(<span class="hljs-string">&quot;Zombie&quot;</span>);<br>  <span class="hljs-keyword">const</span> zombieContract = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ZombieContract</span>.<span class="hljs-title function_">deploy</span>();<br>  <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">deployed</span>();<br><br>  <span class="hljs-comment">// 发送创建僵尸交易</span><br>  <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">createRandomZombie</span>(<span class="hljs-string">&quot;我的第二个僵尸&quot;</span>);<br>  <span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>();<br><br>  <span class="hljs-comment">// 从事件中提取僵尸 ID（CryptoZombies 的 NewZombie 事件参数：uint256 indexed zombieId）</span><br>  <span class="hljs-keyword">const</span> newZombieEvent = receipt.<span class="hljs-property">logs</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">log</span> =&gt;</span> log.<span class="hljs-property">event</span> === <span class="hljs-string">&quot;NewZombie&quot;</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;创建的僵尸 ID：&quot;</span>, newZombieEvent.<span class="hljs-property">args</span>.<span class="hljs-property">zombieId</span>.<span class="hljs-title function_">toString</span>());<br>&#125;<br><br><span class="hljs-title function_">main</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>  process.<span class="hljs-property">exitCode</span> = <span class="hljs-number">1</span>;<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<p>运行脚本后，能看到具体的僵尸 ID，这就是实战中常用的“从事件提取关键数据”。</p>
<h3 id="关键：这阶段不用学-Ethers-js-所有功能"><a href="#关键：这阶段不用学-Ethers-js-所有功能" class="headerlink" title="关键：这阶段不用学 Ethers.js 所有功能"></a>关键：这阶段不用学 Ethers.js 所有功能</h3><p>只需要掌握 3 个核心：</p>
<ul>
<li>用 Hardhat 的 <code>getContractFactory</code> 快速绑定合约（不用手动处理 ABI）</li>
<li>读函数：直接调用合约方法，不用传 gas</li>
<li>写函数：调用后等待 <code>tx.wait()</code>，处理回执和事件</li>
</ul>
<p>文档只看 Ethers.js 官网的「核心模块」：</p>
<ul>
<li>Provider：<a target="_blank" rel="noopener" href="https://docs.ethers.org/v6/api/providers/">https://docs.ethers.org/v6/api/providers/</a> （只看 JsonRpcProvider）</li>
<li>Signer：<a target="_blank" rel="noopener" href="https://docs.ethers.org/v6/api/signer/">https://docs.ethers.org/v6/api/signer/</a> （只看 Wallet 和 Hardhat 自动注入的 Signer）</li>
<li>Contract：<a target="_blank" rel="noopener" href="https://docs.ethers.org/v6/api/contract/">https://docs.ethers.org/v6/api/contract/</a> （只看 contract.methods 调用）</li>
</ul>
<h2 id="二、第二阶段：补上“合约测试”（3-4-天）"><a href="#二、第二阶段：补上“合约测试”（3-4-天）" class="headerlink" title="二、第二阶段：补上“合约测试”（3-4 天）"></a>二、第二阶段：补上“合约测试”（3-4 天）</h2><p>目标：<strong>用 Ethers.js + Hardhat 写测试用例</strong>，你已经知道测试重要，现在落地到实操，测试用例是“保障合约正确”的核心，且 Hardhat 内置测试框架（Mocha+Chai），不用额外学习新工具。</p>
<h3 id="核心动作-1：理解测试的核心逻辑（不用复杂，先覆盖基础场景）"><a href="#核心动作-1：理解测试的核心逻辑（不用复杂，先覆盖基础场景）" class="headerlink" title="核心动作 1：理解测试的核心逻辑（不用复杂，先覆盖基础场景）"></a>核心动作 1：理解测试的核心逻辑（不用复杂，先覆盖基础场景）</h3><p>测试用例主要测 3 类场景：</p>
<ol>
<li>读函数返回正确结果</li>
<li>写函数执行后状态正确（比如创建僵尸后，数量+1）</li>
<li>异常场景（比如非管理员不能调用某个函数）</li>
</ol>
<h3 id="核心动作-2：写第一个测试用例（基于-CryptoZombies-合约）"><a href="#核心动作-2：写第一个测试用例（基于-CryptoZombies-合约）" class="headerlink" title="核心动作 2：写第一个测试用例（基于 CryptoZombies 合约）"></a>核心动作 2：写第一个测试用例（基于 CryptoZombies 合约）</h3><p>在项目中创建 <code>test/</code> 文件夹，新建 <code>zombie-test.js</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; expect &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;chai&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; ethers &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;hardhat&quot;</span>);<br><br><span class="hljs-title function_">describe</span>(<span class="hljs-string">&quot;ZombieContract&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> zombieContract;<br>  <span class="hljs-keyword">let</span> owner; <span class="hljs-comment">// 测试账户</span><br><br>  <span class="hljs-comment">// 每个测试用例执行前，部署一次合约</span><br>  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    [owner] = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getSigners</span>(); <span class="hljs-comment">// Hardhat 自动获取测试账户</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">ZombieContract</span> = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getContractFactory</span>(<span class="hljs-string">&quot;Zombie&quot;</span>);<br>    zombieContract = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ZombieContract</span>.<span class="hljs-title function_">deploy</span>();<br>    <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">deployed</span>();<br>  &#125;);<br><br>  <span class="hljs-comment">// 测试 1：读函数 - 初始僵尸数量为 0</span><br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;should have 0 zombies initially&quot;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> zombieCount = <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">getZombiesByOwner</span>(owner.<span class="hljs-property">address</span>);<br>    <span class="hljs-title function_">expect</span>(zombieCount).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// 断言：初始数量为 0</span><br>  &#125;);<br><br>  <span class="hljs-comment">// 测试 2：写函数 - 创建僵尸后数量+1，且事件正确</span><br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;should create a zombie and emit NewZombie event&quot;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 测试写函数+事件</span><br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(zombieContract.<span class="hljs-title function_">createRandomZombie</span>(<span class="hljs-string">&quot;测试僵尸&quot;</span>))<br>      .<span class="hljs-property">to</span>.<span class="hljs-title function_">emit</span>(zombieContract, <span class="hljs-string">&quot;NewZombie&quot;</span>) <span class="hljs-comment">// 断言事件被触发</span><br>      .<span class="hljs-title function_">withArgs</span>(owner.<span class="hljs-property">address</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 断言事件参数（第一个僵尸 ID 是 0）</span><br><br>    <span class="hljs-comment">// 测试状态变化</span><br>    <span class="hljs-keyword">const</span> zombieCount = <span class="hljs-keyword">await</span> zombieContract.<span class="hljs-title function_">getZombiesByOwner</span>(owner.<span class="hljs-property">address</span>);<br>    <span class="hljs-title function_">expect</span>(zombieCount).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// 断言数量变为 1</span><br>  &#125;);<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<h3 id="核心动作-3：运行测试用例，查看结果"><a href="#核心动作-3：运行测试用例，查看结果" class="headerlink" title="核心动作 3：运行测试用例，查看结果"></a>核心动作 3：运行测试用例，查看结果</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat <span class="hljs-built_in">test</span>  <span class="hljs-comment"># 运行所有测试用例</span><br></code></pre></div></td></tr></table></figure>

<p>如果测试通过，会显示绿色的 <code>passing</code>；如果失败，会提示具体哪一步断言错误，你可以回到 Remix 检查合约逻辑，或修改测试用例。</p>
<h3 id="关键：测试不用写得太复杂"><a href="#关键：测试不用写得太复杂" class="headerlink" title="关键：测试不用写得太复杂"></a>关键：测试不用写得太复杂</h3><p>新手阶段，每个合约写 3-5 个核心测试用例即可，重点覆盖“核心功能是否正常”“关键状态是否正确”，后续再学复杂场景（比如重入攻击测试）。</p>
<h3 id="三、第三阶段：落地小项目（5-7-天）"><a href="#三、第三阶段：落地小项目（5-7-天）" class="headerlink" title="三、第三阶段：落地小项目（5-7 天）"></a>三、第三阶段：落地小项目（5-7 天）</h3><p>目标：<strong>把前面学的所有知识串起来，完成一个“从合约编写→测试→Ethers.js 交互”的完整项目</strong>，形成肌肉记忆，不再迷茫。</p>
<h3 id="推荐项目：简单-NFT-合约（覆盖你熟悉的知识点，且交互场景清晰）"><a href="#推荐项目：简单-NFT-合约（覆盖你熟悉的知识点，且交互场景清晰）" class="headerlink" title="推荐项目：简单 NFT 合约（覆盖你熟悉的知识点，且交互场景清晰）"></a>推荐项目：简单 NFT 合约（覆盖你熟悉的知识点，且交互场景清晰）</h3><p>项目需求：</p>
<ol>
<li>编写一个极简 NFT 合约（支持铸造、查询余额、转账）</li>
<li>用 Hardhat + Ethers.js 写测试用例（覆盖铸造、转账、余额查询）</li>
<li>用 Ethers.js 写脚本：批量铸造 3 个 NFT，查询某个地址的 NFT 列表，转账一个 NFT</li>
<li>部署到 Sepolia 测试网（可选，体验真实链上交互）</li>
</ol>
<h3 id="具体步骤（跟着做就行）"><a href="#具体步骤（跟着做就行）" class="headerlink" title="具体步骤（跟着做就行）"></a>具体步骤（跟着做就行）</h3><h4 id="步骤-1：在-Remix-写-NFT-合约（简化版-ERC721）"><a href="#步骤-1：在-Remix-写-NFT-合约（简化版-ERC721）" class="headerlink" title="步骤 1：在 Remix 写 NFT 合约（简化版 ERC721）"></a>步骤 1：在 Remix 写 NFT 合约（简化版 ERC721）</h4><p>不用写完整 ERC721，用 OpenZeppelin 库（降低编写难度，实战中也常用）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs solidity">// contracts/MySimpleNFT.sol<br>// SPDX-License-Identifier: MIT<br>pragma solidity ^0.8.20;<br><br>import &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;;<br>import &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;<br><br>contract MySimpleNFT is ERC721, Ownable &#123;<br>  uint256 public tokenIdCounter; // NFT ID 计数器<br><br>  // 构造函数：初始化 NFT 名称和符号<br>  constructor() ERC721(&quot;MySimpleNFT&quot;, &quot;MSN&quot;) Ownable(msg.sender) &#123;&#125;<br><br>  // 铸造函数：只有拥有者能铸造<br>  function mint(address to) public onlyOwner returns (uint256) &#123;<br>    uint256 newTokenId = tokenIdCounter++;<br>    _safeMint(to, newTokenId);<br>    return newTokenId;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<h4 id="步骤-2：在-Hardhat-中安装-OpenZeppelin-库"><a href="#步骤-2：在-Hardhat-中安装-OpenZeppelin-库" class="headerlink" title="步骤 2：在 Hardhat 中安装 OpenZeppelin 库"></a>步骤 2：在 Hardhat 中安装 OpenZeppelin 库</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npm install @openzeppelin/contracts<br></code></pre></div></td></tr></table></figure>

<h4 id="步骤-3：编译合约"><a href="#步骤-3：编译合约" class="headerlink" title="步骤 3：编译合约"></a>步骤 3：编译合约</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat compile<br></code></pre></div></td></tr></table></figure>

<h4 id="步骤-4：写测试用例（test-my-nft-test-js）"><a href="#步骤-4：写测试用例（test-my-nft-test-js）" class="headerlink" title="步骤 4：写测试用例（test&#x2F;my-nft-test.js）"></a>步骤 4：写测试用例（test&#x2F;my-nft-test.js）</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; expect &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;chai&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; ethers &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;hardhat&quot;</span>);<br><br><span class="hljs-title function_">describe</span>(<span class="hljs-string">&quot;MySimpleNFT&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> myNFT;<br>  <span class="hljs-keyword">let</span> owner, user1;<br><br>  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    [owner, user1] = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getSigners</span>();<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">MySimpleNFT</span> = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getContractFactory</span>(<span class="hljs-string">&quot;MySimpleNFT&quot;</span>);<br>    myNFT = <span class="hljs-keyword">await</span> <span class="hljs-title class_">MySimpleNFT</span>.<span class="hljs-title function_">deploy</span>();<br>    <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">deployed</span>();<br>  &#125;);<br><br>  <span class="hljs-comment">// 测试：初始 tokenId 为 0</span><br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;should start with tokenId 0&quot;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">expect</span>(<span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">tokenIdCounter</span>()).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-number">0</span>);<br>  &#125;);<br><br>  <span class="hljs-comment">// 测试：拥有者能铸造 NFT，余额正确</span><br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;should allow owner to mint NFT&quot;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">mint</span>(owner.<span class="hljs-property">address</span>);<br>    <span class="hljs-title function_">expect</span>(<span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">balanceOf</span>(owner.<span class="hljs-property">address</span>)).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-title function_">expect</span>(<span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">ownerOf</span>(<span class="hljs-number">0</span>)).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(owner.<span class="hljs-property">address</span>);<br>  &#125;);<br><br>  <span class="hljs-comment">// 测试：非拥有者不能铸造（异常场景）</span><br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;should reject mint from non-owner&quot;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(myNFT.<span class="hljs-title function_">connect</span>(user1).<span class="hljs-title function_">mint</span>(user1.<span class="hljs-property">address</span>)).<span class="hljs-property">to</span>.<span class="hljs-property">be</span>.<span class="hljs-title function_">revertedWith</span>(<br>      <span class="hljs-string">&quot;Ownable: caller is not the owner&quot;</span><br>    );<br>  &#125;);<br><br>  <span class="hljs-comment">// 测试：NFT 转账功能</span><br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;should transfer NFT correctly&quot;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">mint</span>(owner.<span class="hljs-property">address</span>); <span class="hljs-comment">//  owner 铸造 NFT ID 0</span><br>    <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">transferFrom</span>(owner.<span class="hljs-property">address</span>, user1.<span class="hljs-property">address</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 转账给 user1</span><br>    <span class="hljs-title function_">expect</span>(<span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">balanceOf</span>(user1.<span class="hljs-property">address</span>)).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-title function_">expect</span>(<span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">ownerOf</span>(<span class="hljs-number">0</span>)).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(user1.<span class="hljs-property">address</span>);<br>  &#125;);<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<p>运行测试：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat <span class="hljs-built_in">test</span><br></code></pre></div></td></tr></table></figure>

<h4 id="步骤-5：写-Ethers-js-交互脚本（批量铸造-查询-转账）"><a href="#步骤-5：写-Ethers-js-交互脚本（批量铸造-查询-转账）" class="headerlink" title="步骤 5：写 Ethers.js 交互脚本（批量铸造+查询+转账）"></a>步骤 5：写 Ethers.js 交互脚本（批量铸造+查询+转账）</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// scripts/nft-interact.js</span><br><span class="hljs-keyword">const</span> hre = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;hardhat&quot;</span>);<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> [owner, user1] = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getSigners</span>();<br><br>  <span class="hljs-comment">// 部署合约</span><br>  <span class="hljs-keyword">const</span> <span class="hljs-title class_">MySimpleNFT</span> = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getContractFactory</span>(<span class="hljs-string">&quot;MySimpleNFT&quot;</span>);<br>  <span class="hljs-keyword">const</span> myNFT = <span class="hljs-keyword">await</span> <span class="hljs-title class_">MySimpleNFT</span>.<span class="hljs-title function_">deploy</span>();<br>  <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">deployed</span>();<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;NFT 合约地址：&quot;</span>, myNFT.<span class="hljs-property">address</span>);<br><br>  <span class="hljs-comment">// 1. 批量铸造 3 个 NFT 给 owner</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;开始批量铸造...&quot;</span>);<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;<br>    <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">mint</span>(owner.<span class="hljs-property">address</span>);<br>    <span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`铸造成功！NFT ID：<span class="hljs-subst">$&#123;i&#125;</span>`</span>);<br>  &#125;<br><br>  <span class="hljs-comment">// 2. 查询 owner 的 NFT 余额</span><br>  <span class="hljs-keyword">const</span> ownerBalance = <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">balanceOf</span>(owner.<span class="hljs-property">address</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`owner 余额：<span class="hljs-subst">$&#123;ownerBalance.toString()&#125;</span>`</span>);<br><br>  <span class="hljs-comment">// 3. 转账 NFT ID 1 给 user1</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;开始转账 NFT ID 1 给 user1...&quot;</span>);<br>  <span class="hljs-keyword">const</span> transferTx = <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">transferFrom</span>(owner.<span class="hljs-property">address</span>, user1.<span class="hljs-property">address</span>, <span class="hljs-number">1</span>);<br>  <span class="hljs-keyword">await</span> transferTx.<span class="hljs-title function_">wait</span>();<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;转账成功！&quot;</span>);<br><br>  <span class="hljs-comment">// 验证转账结果</span><br>  <span class="hljs-keyword">const</span> user1Balance = <span class="hljs-keyword">await</span> myNFT.<span class="hljs-title function_">balanceOf</span>(user1.<span class="hljs-property">address</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`user1 余额：<span class="hljs-subst">$&#123;user1Balance.toString()&#125;</span>`</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`NFT ID 1 的拥有者：<span class="hljs-subst">$&#123;<span class="hljs-keyword">await</span> myNFT.ownerOf(<span class="hljs-number">1</span>)&#125;</span>`</span>);<br>&#125;<br><br><span class="hljs-title function_">main</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);<br>  process.<span class="hljs-property">exitCode</span> = <span class="hljs-number">1</span>;<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<p>运行脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat run scripts/nft-interact.js --network localhost<br></code></pre></div></td></tr></table></figure>

<h4 id="步骤-6：（可选）部署到-Sepolia-测试网"><a href="#步骤-6：（可选）部署到-Sepolia-测试网" class="headerlink" title="步骤 6：（可选）部署到 Sepolia 测试网"></a>步骤 6：（可选）部署到 Sepolia 测试网</h4><ol>
<li>配置 Hardhat 测试网参数（修改 <code>hardhat.config.js</code>）：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@nomiclabs/hardhat-ethers&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">solidity</span>: <span class="hljs-string">&quot;0.8.20&quot;</span>,<br>  <span class="hljs-attr">networks</span>: &#123;<br>    <span class="hljs-attr">sepolia</span>: &#123;<br>      <span class="hljs-attr">url</span>: <span class="hljs-string">&quot;https://eth-sepolia.g.alchemy.com/v2/你的 Alchemy API 密钥&quot;</span>, <span class="hljs-comment">// 之前准备的 Alchemy 节点</span><br>      <span class="hljs-attr">accounts</span>: [<span class="hljs-string">&quot;你的测试账户私钥&quot;</span>] <span class="hljs-comment">// 测试账户私钥（不要硬编码到生产环境）</span><br>    &#125;<br>  &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>

<ol start="2">
<li>部署合约：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npx hardhat run scripts/nft-interact.js --network sepolia<br></code></pre></div></td></tr></table></figure>

<ol start="3">
<li>在 Sepolia Etherscan 输入合约地址，查看合约状态和交易记录。</li>
</ol>
<h3 id="四、避坑-心态调整（新手必看）"><a href="#四、避坑-心态调整（新手必看）" class="headerlink" title="四、避坑&amp;心态调整（新手必看）"></a>四、避坑&amp;心态调整（新手必看）</h3><ol>
<li><strong>工具不用全精通</strong>：Truffle、TronBox 暂时放一放，先把 Hardhat+Remix+Ethers.js 用熟，这三个足够覆盖 80% 的开发场景。</li>
<li><strong>Ethers.js 文档不用全看</strong>：聚焦“合约交互”相关模块，遇到问题再查文档，不要一开始就啃完整文档（容易劝退）。</li>
<li><strong>测试用例不用写太多</strong>：新手先覆盖核心功能，后续做复杂项目再补充异常场景、边界条件。</li>
<li><strong>遇到报错不要慌</strong>：Hardhat 报错会提示具体行号，优先查“合约是否编译通过”“参数是否正确”“账户是否有权限”，其次查 Ethers.js 文档或 Stack Overflow（关键词：Ethers.js + 报错信息）。</li>
</ol>
<h3 id="五、后续拓展方向（完成项目后再考虑）"><a href="#五、后续拓展方向（完成项目后再考虑）" class="headerlink" title="五、后续拓展方向（完成项目后再考虑）"></a>五、后续拓展方向（完成项目后再考虑）</h3><ol>
<li>学习 Ethers.js 前端集成：对接 MetaMask，写一个简单网页（用 Vue&#x2F;React），实现“用户点击按钮铸造 NFT”。</li>
<li>深入 Hardhat 插件：比如 <code>hardhat-etherscan</code>（合约验证）、<code>hardhat-gas-reporter</code>（gas 分析）。</li>
<li>学习 Chainlink 实操：在你的 NFT 合约中集成 Chainlink VRF，实现“随机铸造 NFT 属性”（衔接你之前学的 Chainlink 知识）。</li>
<li>尝试更复杂的合约：比如 ERC20+NFT 结合的合约，或简单的 DeFi 合约（如质押挖矿）。</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>你现在的核心问题是“知识碎片化，没有形成闭环”，所以下一步不用学新东西，而是把已有的知识“串起来”：</p>
<ol>
<li>用 Hardhat 简化 Ethers.js 学习，专注核心交互；</li>
<li>用测试用例巩固合约逻辑，知道“怎么验证合约正确”；</li>
<li>用一个小项目落地所有知识点，形成“编写→测试→交互”的完整流程。</li>
</ol>
<p>按这个路径走，1-2 周就能摆脱迷茫，并且能独立完成“合约+交互”的开发，后续再拓展新工具、新知识点就会很顺畅！</p>
<h2 id="deepseek的回答"><a href="#deepseek的回答" class="headerlink" title="deepseek的回答"></a>deepseek的回答</h2><p>看到你的学习历程，我能感受到你现在正处于一个<strong>从“了解概念”到“实际构建”的关键过渡期</strong>。你遇到的困难（工具复杂、文档繁多、方向模糊）是每一位区块链开发者都会经历的“成长阵痛”。别担心，我们来制定一个清晰、可执行的下一步计划。</p>
<h3 id="核心问题诊断与破局思路"><a href="#核心问题诊断与破局思路" class="headerlink" title="核心问题诊断与破局思路"></a>核心问题诊断与破局思路</h3><p>你的核心问题不是“学得不够”，而是<strong>缺乏一个明确、具体的项目目标来串联所有知识点</strong>。工具和库（ethers.js, Hardhat）是“器”，而项目是“术”与“道”。你要做的是：<strong>通过做一个具体的、感兴趣的项目，来驱动对工具和库的学习</strong>。</p>
<p>我给你的建议是：<strong>暂时放下对“掌握所有工具”的执念，选定一个技术栈，围绕一个迷你项目深钻下去。</strong></p>
<h3 id="下一步行动方案：四步走战略"><a href="#下一步行动方案：四步走战略" class="headerlink" title="下一步行动方案：四步走战略"></a>下一步行动方案：四步走战略</h3><h4 id="第一步：选定并专注一个开发框架——推荐-Hardhat"><a href="#第一步：选定并专注一个开发框架——推荐-Hardhat" class="headerlink" title="第一步：选定并专注一个开发框架——推荐 Hardhat"></a>第一步：选定并专注一个开发框架——推荐 Hardhat</h4><p>你已安装多个框架，这反而造成选择困难。我强烈推荐你<strong>将 Hardhat 作为主力</strong>，原因如下：</p>
<ul>
<li><strong>与 Remix 互补</strong>：你熟悉 Remix 的编写和部署，Hardhat 则擅长<strong>本地测试、部署脚本和任务自动化</strong>。</li>
<li><strong>测试体验极佳</strong>：它内置了 <code>hardhat-chai-matchers</code>，写测试用例非常直观，完美契合你“测试很重要”的认知。</li>
<li><strong>生态系统活跃</strong>：插件丰富，社区支持好，是当前最主流的专业开发框架。</li>
</ul>
<p><strong>具体任务</strong>：</p>
<ol>
<li>在你的Linux虚拟机中，创建一个全新的Hardhat项目：<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> my-first-dapp &amp;&amp; <span class="hljs-built_in">cd</span> my-first-dapp<br>npm init -y<br>npm install --save-dev hardhat<br>npx hardhat init<br></code></pre></div></td></tr></table></figure>
选择 “<strong>Create a JavaScript project</strong>”（暂时避开TypeScript，减少复杂度）。</li>
<li>浏览生成的项目结构：重点关注 <code>contracts/</code>, <code>scripts/</code>, <code>test/</code> 目录和 <code>hardhat.config.js</code> 文件。</li>
<li>运行 <code>npx hardhat test</code>，感受一下测试流程。</li>
</ol>
<h4 id="第二步：以项目驱动的方式学习-ethers-js"><a href="#第二步：以项目驱动的方式学习-ethers-js" class="headerlink" title="第二步：以项目驱动的方式学习 ethers.js"></a>第二步：以项目驱动的方式学习 ethers.js</h4><p>不要试图通读全部文档。<strong>带着任务去查文档</strong>，效率最高。Ethers.js 的核心就是这几件事：</p>
<ol>
<li><strong>连接钱包&#x2F;提供商</strong>（Provider）</li>
<li><strong>读取合约数据</strong>（Call）</li>
<li><strong>发送交易</strong>（Send Transaction）</li>
<li><strong>监听事件</strong>（Event）</li>
</ol>
<p><strong>迷你项目建议：构建一个“存款罐”智能合约及前端</strong><br>这个项目小到可管理，但涵盖了核心流程：</p>
<ul>
<li><strong>合约功能</strong>：一个可以接收ETH的合约，记录每个地址的存款金额，允许所有者提取。</li>
<li><strong>前端功能</strong>：一个网页，可以连接MetaMask，查看余额，进行存款。</li>
</ul>
<p><strong>分模块学习 ethers.js</strong>：</p>
<ul>
<li><p><strong>模块A：连接与读取</strong></p>
<ul>
<li>任务：在Hardhat的测试脚本或一个单独的Node.js脚本中，连接本地Hardhat网络或以太坊测试网。</li>
<li>学习点：<code>ethers.providers.JsonRpcProvider</code>, <code>provider.getBalance()</code></li>
<li>代码实践：编写脚本，读取测试网某个账户的ETH余额。</li>
</ul>
</li>
<li><p><strong>模块B：与合约交互（只读）</strong></p>
<ul>
<li>任务：为你编写的“存款罐”合约，写一个测试脚本，调用其“查看总存款”的函数。</li>
<li>学习点：<code>new ethers.Contract(address, abi, provider)</code>，调用 <code>contract.totalDeposits()</code>。</li>
</ul>
</li>
<li><p><strong>模块C：与合约交互（写入）</strong></p>
<ul>
<li>任务：在测试脚本中，模拟一个用户向“存款罐”存款。</li>
<li>学习点：<code>contract.connect(signer).deposit(&#123;value: ...&#125;)</code>，理解 <code>signer</code>（签名者）的概念。</li>
</ul>
</li>
</ul>
<p><strong>关键技巧</strong>：Hardhat测试中，你可以直接使用 <code>ethers</code> 全局变量和 <code>hre.ethers</code>，无需复杂配置。从写测试用例开始学，比直接写前端更简单。</p>
<h4 id="第三步：将“测试驱动开发”落到实处"><a href="#第三步：将“测试驱动开发”落到实处" class="headerlink" title="第三步：将“测试驱动开发”落到实处"></a>第三步：将“测试驱动开发”落到实处</h4><p>你现在已经知道测试重要，现在是实践的时候。为“存款罐”合约编写完善的测试。</p>
<p><strong>示例测试思路（在 <code>test/DepositBox.js</code> 中）</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; expect &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;chai&quot;</span>);<br><br><span class="hljs-title function_">describe</span>(<span class="hljs-string">&quot;DepositBox&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&quot;Should accept ETH deposit&quot;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> [owner, addr1] = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getSigners</span>();<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">DepositBox</span> = <span class="hljs-keyword">await</span> ethers.<span class="hljs-title function_">getContractFactory</span>(<span class="hljs-string">&quot;DepositBox&quot;</span>);<br>    <span class="hljs-keyword">const</span> depositBox = <span class="hljs-keyword">await</span> <span class="hljs-title class_">DepositBox</span>.<span class="hljs-title function_">deploy</span>();<br><br>    <span class="hljs-comment">// 测试存款</span><br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(<span class="hljs-function">() =&gt;</span><br>      addr1.<span class="hljs-title function_">sendTransaction</span>(&#123; <span class="hljs-attr">to</span>: depositBox.<span class="hljs-property">address</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> &#125;)<br>    ).<span class="hljs-property">to</span>.<span class="hljs-title function_">changeEtherBalance</span>(addr1, -<span class="hljs-number">100</span>); <span class="hljs-comment">// 检查addr1余额减少</span><br><br>    <span class="hljs-comment">// 检查合约余额增加</span><br>    <span class="hljs-title function_">expect</span>(<span class="hljs-keyword">await</span> ethers.<span class="hljs-property">provider</span>.<span class="hljs-title function_">getBalance</span>(depositBox.<span class="hljs-property">address</span>)).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-number">100</span>);<br>  &#125;);<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<p>通过写测试，你会被迫思考合约的所有行为边界，这是提升代码质量最快的方法。</p>
<h4 id="第四步：整合与扩展——做一个简单前端"><a href="#第四步：整合与扩展——做一个简单前端" class="headerlink" title="第四步：整合与扩展——做一个简单前端"></a>第四步：整合与扩展——做一个简单前端</h4><p>当你的合约通过测试后，可以尝试用前端与之交互。</p>
<ol>
<li><strong>使用 Vite 或 Create React App 快速搭建一个前端项目</strong>。</li>
<li><strong>在前端集成 ethers.js</strong>：<code>npm install ethers</code></li>
<li><strong>实现核心功能</strong>：<ul>
<li>使用 <code>window.ethereum</code> 检测并连接MetaMask（<code>ethers.providers.Web3Provider</code>）。</li>
<li>使用连接后的 <code>provider</code> 和 <code>signer</code> 来实例化你的合约。</li>
<li>制作一个按钮，调用合约的 <code>deposit</code> 函数。</li>
</ul>
</li>
</ol>
<p>这时，你会遇到前端开发的挑战（状态管理、错误处理等），但这会将你的学习扩展到全栈DApp开发。</p>
<h3 id="学习资源与心态调整建议"><a href="#学习资源与心态调整建议" class="headerlink" title="学习资源与心态调整建议"></a>学习资源与心态调整建议</h3><ol>
<li><p><strong>文档阅读法</strong>：</p>
<ul>
<li><strong>ethers.js</strong>：直奔 <a target="_blank" rel="noopener" href="https://docs.ethers.org/v6/">v6文档</a>，只看 <strong>API → Providers</strong> 和 <strong>API → Contract</strong> 这两个核心章节。其他部分随用随查。</li>
<li><strong>Hardhat</strong>：精读 <a target="_blank" rel="noopener" href="https://hardhat.org/tutorial">Hardhat Tutorial</a>，它引导你完成一个完整的任务。</li>
</ul>
</li>
<li><p><strong>社区与求助</strong>：</p>
<ul>
<li>遇到具体错误时，将错误信息直接复制到 Google 或 Stack Overflow 搜索，大概率已有解决方案。</li>
<li>在 Hardhat 和 ethers.js 的 Discord 或 GitHub Discussions 中提问。</li>
</ul>
</li>
<li><p><strong>心态管理</strong>：</p>
<ul>
<li><strong>接受“螺旋式上升”</strong>：你可能需要在“写代码 → 查文档 → 报错 → 搜索 → 解决”的循环中反复多次。这是最有效的学习过程。</li>
<li><strong>完成比完美重要</strong>：你的第一个项目可以很丑、效率不高，但一定要把它<strong>完整地走通</strong>：编写、测试、部署、前端交互。这个闭环的经验价值千金。</li>
</ul>
</li>
</ol>
<h3 id="总结：你的立即行动清单"><a href="#总结：你的立即行动清单" class="headerlink" title="总结：你的立即行动清单"></a>总结：你的立即行动清单</h3><ol>
<li><strong>今天</strong>：用 Hardhat 创建一个新项目，部署一个简单的 “Hello World” 合约并运行测试。</li>
<li><strong>本周末</strong>：完成 “存款罐” 合约及其 <strong>全部测试用例</strong>。</li>
<li><strong>下周</strong>：为 “存款罐” 合约编写一个最简单的前端页面，实现连接钱包和存款功能。</li>
<li><strong>长期</strong>：以此为基础，构思并开发一个你真正感兴趣的、稍复杂的项目（例如：一个多签钱包、一个代币质押池）。</li>
</ol>
<p>你已具备了扎实的基础知识，现在需要的只是<strong>将注意力从“学习所有”转移到“构建一个”上来</strong>。一旦你通过第一个小项目打通了任督二脉，所有的文档和工具都会变得亲切起来。动手开始吧！</p>
<h1 id="我该如何学习-合约交互库-ether-js"><a href="#我该如何学习-合约交互库-ether-js" class="headerlink" title="我该如何学习 合约交互库 ether.js"></a>我该如何学习 合约交互库 ether.js</h1><p>学习 Ethers.js 的核心是<strong>围绕“实操”展开</strong>——先掌握“连接链→操作合约→处理交易”的固定流程，再逐步细化细节（如 gas 控制、签名安全、事件监听）。以下是一套循序渐进的学习路径，从环境搭建到实战落地，完全匹配你的核心需求：</p>
<h2 id="一、前置准备：搭建最小可运行环境"><a href="#一、前置准备：搭建最小可运行环境" class="headerlink" title="一、前置准备：搭建最小可运行环境"></a>一、前置准备：搭建最小可运行环境</h2><p>Ethers.js 是 Node.js 生态库，先搞定环境，再写代码才不卡壳：</p>
<h3 id="1-基础环境安装"><a href="#1-基础环境安装" class="headerlink" title="1. 基础环境安装"></a>1. 基础环境安装</h3><ul>
<li>安装 Node.js（推荐 v16+，自带 npm）：<a target="_blank" rel="noopener" href="https://nodejs.org/">官网下载</a></li>
<li>初始化项目（创建文件夹，执行命令）：<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> ethers-learn &amp;&amp; <span class="hljs-built_in">cd</span> ethers-learn<br>npm init -y  <span class="hljs-comment"># 生成 package.json</span><br>npm install ethers  <span class="hljs-comment"># 核心库（最新版 v6，语法更简洁）</span><br><span class="hljs-comment"># 可选：安装 hardhat（辅助获取合约 ABI、本地节点，对应你给的示例）</span><br>npm install --save-dev hardhat @nomiclabs/hardhat-ethers ethers<br>npx hardhat  <span class="hljs-comment"># 初始化 hardhat（选 Create an empty hardhat.config.js）</span><br></code></pre></div></td></tr></table></figure></li>
</ul>
<h3 id="2-关键工具准备（必备）"><a href="#2-关键工具准备（必备）" class="headerlink" title="2. 关键工具准备（必备）"></a>2. 关键工具准备（必备）</h3><ul>
<li><strong>测试网节点</strong>：本地节点（Ganache）或第三方节点（Alchemy&#x2F;Infura，免搭节点）<ul>
<li>本地节点：安装 Ganache（<a target="_blank" rel="noopener" href="https://trufflesuite.com/ganache/">官网</a>），启动后会生成 10 个测试账户（带 ETH）和 RPC 地址（如 <code>http://127.0.0.1:7545</code>）</li>
<li>第三方节点（推荐）：注册 Alchemy，创建 Sepolia 测试网项目，获取 RPC 地址（如 <code>https://eth-sepolia.g.alchemy.com/v2/你的API密钥</code>）</li>
</ul>
</li>
<li><strong>测试币</strong>：Sepolia 测试网领 ETH（<a target="_blank" rel="noopener" href="https://sepolia-faucet.pk910.de/">水龙头</a>），用于发送交易</li>
<li><strong>合约 ABI + 地址</strong>：找一个测试网合约（如自己部署的 NFT 合约，或公开测试合约），ABI 是 JSON 格式（合约编译后生成，Hardhat 编译后在 <code>artifacts/contracts/xxx.sol/xxx.json</code> 中）</li>
</ul>
<h2 id="二、核心概念拆解（3个核心对象，必须吃透）"><a href="#二、核心概念拆解（3个核心对象，必须吃透）" class="headerlink" title="二、核心概念拆解（3个核心对象，必须吃透）"></a>二、核心概念拆解（3个核心对象，必须吃透）</h2><p>Ethers.js 的所有合约交互，本质是围绕「Provider + Signer + Contract」三个对象展开，搞懂它们的分工，代码逻辑就通了：</p>
<p>| 对象       | 作用                                  | 核心场景                  |<br>| Provider   | 连接区块链（读链数据，无签名权限）    | 调用合约读函数、查区块&#x2F;交易 |<br>| Signer     | 持有私钥（签名交易，有写链权限）      | 发送交易、调用合约写函数   |<br>| Contract   | 绑定 ABI + 合约地址（JS 操作合约的入口） | 调用合约的读&#x2F;写方法        |</p>
<h3 id="代码示例（快速理解三者关系）"><a href="#代码示例（快速理解三者关系）" class="headerlink" title="代码示例（快速理解三者关系）"></a>代码示例（快速理解三者关系）</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; ethers &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;ethers&quot;</span>);<br><br><span class="hljs-comment">// 1. Provider：连接 Sepolia 测试网（用 Alchemy 节点）</span><br><span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(<span class="hljs-string">&quot;https://eth-sepolia.g.alchemy.com/v2/你的API密钥&quot;</span>);<br><br><span class="hljs-comment">// 2. Signer：用私钥创建签名者（测试用，生产环境绝对不能硬编码私钥！）</span><br><span class="hljs-keyword">const</span> privateKey = <span class="hljs-string">&quot;你的测试账户私钥（Ganache/Metamask 导出）&quot;</span>;<br><span class="hljs-keyword">const</span> signer = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Wallet</span>(privateKey, provider);  <span class="hljs-comment">// 绑定 Provider，让签名者知道连哪个链</span><br><br><span class="hljs-comment">// 3. Contract：绑定合约 ABI + 地址（示例：测试网 NFT 合约）</span><br><span class="hljs-keyword">const</span> contractABI = [<span class="hljs-comment">/* 合约 ABI 的 JSON 数组，比如 mint 函数的定义 */</span>];<br><span class="hljs-keyword">const</span> contractAddress = <span class="hljs-string">&quot;0x123...&quot;</span>;  <span class="hljs-comment">// 测试网合约地址</span><br><span class="hljs-keyword">const</span> nftContract = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Contract</span>(contractAddress, contractABI, signer);  <span class="hljs-comment">// 绑定 Signer（可写），若只读则绑定 Provider</span><br></code></pre></div></td></tr></table></figure>


<h2 id="三、分模块实操（核心需求逐一突破）"><a href="#三、分模块实操（核心需求逐一突破）" class="headerlink" title="三、分模块实操（核心需求逐一突破）"></a>三、分模块实操（核心需求逐一突破）</h2><p>按你的核心需求拆分，每个模块写“可直接运行的代码”，多练 2 次就熟了：</p>
<h3 id="模块1：连接区块链（本地-测试网）"><a href="#模块1：连接区块链（本地-测试网）" class="headerlink" title="模块1：连接区块链（本地&#x2F;测试网）"></a>模块1：连接区块链（本地&#x2F;测试网）</h3><p>核心是创建 <code>Provider</code>，支持 3 种常见场景：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; ethers &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;ethers&quot;</span>);<br><br><span class="hljs-comment">// 场景1：连接本地 Ganache 节点</span><br><span class="hljs-keyword">const</span> localProvider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(<span class="hljs-string">&quot;http://127.0.0.1:7545&quot;</span>);<br><br><span class="hljs-comment">// 场景2：连接测试网（Sepolia，Alchemy/Infura）</span><br><span class="hljs-keyword">const</span> testnetProvider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(<span class="hljs-string">&quot;https://eth-sepolia.g.alchemy.com/v2/你的API密钥&quot;</span>);<br><br><span class="hljs-comment">// 场景3：前端连接 MetaMask（浏览器环境，MetaMask 会注入 window.ethereum）</span><br><span class="hljs-comment">// if (window.ethereum) &#123;</span><br><span class="hljs-comment">//   const provider = new ethers.BrowserProvider(window.ethereum);</span><br><span class="hljs-comment">//   const signer = await provider.getSigner();  // 无需硬编码私钥，MetaMask 签名</span><br><span class="hljs-comment">// &#125;</span><br><br><span class="hljs-comment">// 验证连接成功：查当前区块号</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkConnection</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> blockNumber = <span class="hljs-keyword">await</span> localProvider.<span class="hljs-title function_">getBlockNumber</span>();<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;当前区块号：&quot;</span>, blockNumber); <span class="hljs-comment">// 输出数字说明连接成功</span><br>&#125;<br><span class="hljs-title function_">checkConnection</span>();<br></code></pre></div></td></tr></table></figure>

<h3 id="模块2：加载合约-ABI（2种常用方式）"><a href="#模块2：加载合约-ABI（2种常用方式）" class="headerlink" title="模块2：加载合约 ABI（2种常用方式）"></a>模块2：加载合约 ABI（2种常用方式）</h3><p>ABI 是 JS 和合约沟通的“翻译器”，必须正确加载：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 方式1：直接复制 ABI 数组（适合简单合约）</span><br><span class="hljs-keyword">const</span> simpleABI = [<br>  <span class="hljs-string">&quot;function mint(string calldata tokenURI) external returns (uint256)&quot;</span>,  <span class="hljs-comment">// 写函数</span><br>  <span class="hljs-string">&quot;function balanceOf(address owner) external view returns (uint256)&quot;</span>   <span class="hljs-comment">// 读函数（view 修饰）</span><br>];<br><br><span class="hljs-comment">// 方式2：导入 Hardhat 编译后的 ABI（推荐，适合复杂合约）</span><br><span class="hljs-comment">// 假设合约叫 MyNFT.sol，编译后生成 artifacts/contracts/MyNFT.sol/MyNFT.json</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MyNFTABI</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./artifacts/contracts/MyNFT.sol/MyNFT.json&quot;</span>).<span class="hljs-property">abi</span>;<br><br><span class="hljs-comment">// 方式3：从 JSON 文件导入（单独保存 ABI 为 nft-abi.json）</span><br><span class="hljs-comment">// const MyNFTABI = require(&quot;./nft-abi.json&quot;);</span><br></code></pre></div></td></tr></table></figure>

<h3 id="模块3：调用合约读函数（无交易费，无需签名）"><a href="#模块3：调用合约读函数（无交易费，无需签名）" class="headerlink" title="模块3：调用合约读函数（无交易费，无需签名）"></a>模块3：调用合约读函数（无交易费，无需签名）</h3><p>读函数用 <code>view</code> 或 <code>pure</code> 修饰，只需要 <code>Provider</code> 或绑定 <code>Provider</code> 的 <code>Contract</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">readContract</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(<span class="hljs-string">&quot;https://eth-sepolia.g.alchemy.com/v2/你的API密钥&quot;</span>);<br>  <span class="hljs-keyword">const</span> contract = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Contract</span>(contractAddress, <span class="hljs-title class_">MyNFTABI</span>, provider); <span class="hljs-comment">// 只绑定 Provider（读）</span><br><br>  <span class="hljs-comment">// 调用读函数：查询某个地址的 NFT 余额</span><br>  <span class="hljs-keyword">const</span> ownerAddress = <span class="hljs-string">&quot;0x456...&quot;</span>;<br>  <span class="hljs-keyword">const</span> balance = <span class="hljs-keyword">await</span> contract.<span class="hljs-title function_">balanceOf</span>(ownerAddress);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;NFT 余额：&quot;</span>, ethers.<span class="hljs-title function_">formatUnits</span>(balance, <span class="hljs-number">0</span>)); <span class="hljs-comment">// 余额是 uint256，转成数字</span><br>&#125;<br><span class="hljs-title function_">readContract</span>();<br></code></pre></div></td></tr></table></figure>

<h3 id="模块4：调用合约写函数（需交易费，签名交易）"><a href="#模块4：调用合约写函数（需交易费，签名交易）" class="headerlink" title="模块4：调用合约写函数（需交易费，签名交易）"></a>模块4：调用合约写函数（需交易费，签名交易）</h3><p>写函数（如 <code>mint</code>、<code>transfer</code>）会修改链上数据，必须绑定 <code>Signer</code>，核心流程：<strong>调用函数→签名交易→发送上链→等待回执</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">mintNFT</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 1. 初始化 Provider + Signer + Contract</span><br>  <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(<span class="hljs-string">&quot;https://eth-sepolia.g.alchemy.com/v2/你的API密钥&quot;</span>);<br>  <span class="hljs-keyword">const</span> signer = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Wallet</span>(privateKey, provider);<br>  <span class="hljs-keyword">const</span> nftContract = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Contract</span>(contractAddress, <span class="hljs-title class_">MyNFTABI</span>, signer); <span class="hljs-comment">// 绑定 Signer（写）</span><br><br>  <span class="hljs-comment">// 2. 调用写函数（指定参数，可选设置 gas）</span><br>  <span class="hljs-keyword">const</span> tokenURI = <span class="hljs-string">&quot;ipfs://QmXXX...&quot;</span>; <span class="hljs-comment">// NFT 的元数据地址</span><br>  <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> nftContract.<span class="hljs-title function_">mint</span>(tokenURI, &#123;<br>    <span class="hljs-attr">gasLimit</span>: <span class="hljs-number">300000</span>, <span class="hljs-comment">// 可选：指定 gas 上限（防止 gas 无限飙升）</span><br>    <span class="hljs-attr">gasPrice</span>: ethers.<span class="hljs-title function_">parseUnits</span>(<span class="hljs-string">&quot;20&quot;</span>, <span class="hljs-string">&quot;gwei&quot;</span>) <span class="hljs-comment">// 可选：指定 gas 价格（当前链上平均价格即可）</span><br>  &#125;);<br><br>  <span class="hljs-comment">// 3. 等待交易上链（获取回执）</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;交易哈希：&quot;</span>, tx.<span class="hljs-property">hash</span>); <span class="hljs-comment">// 可在 Etherscan 查看交易状态</span><br>  <span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>(); <span class="hljs-comment">// 等待区块确认（默认 1 个确认）</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;交易确认！区块号：&quot;</span>, receipt.<span class="hljs-property">blockNumber</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;铸造的 NFT ID：&quot;</span>, receipt.<span class="hljs-property">logs</span>[<span class="hljs-number">0</span>].<span class="hljs-property">args</span>.<span class="hljs-property">tokenId</span>); <span class="hljs-comment">// 从事件中提取 NFT ID（需合约定义事件）</span><br>&#125;<br><span class="hljs-title function_">mintNFT</span>();<br></code></pre></div></td></tr></table></figure>

<h3 id="模块5：处理交易回执（关键信息提取）"><a href="#模块5：处理交易回执（关键信息提取）" class="headerlink" title="模块5：处理交易回执（关键信息提取）"></a>模块5：处理交易回执（关键信息提取）</h3><p><code>tx.wait()</code> 会返回交易回执，包含核心信息，按需提取：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(&#123;<br>  交易哈希: receipt.<span class="hljs-property">hash</span>,<br>  区块号: receipt.<span class="hljs-property">blockNumber</span>,<br>  消耗 <span class="hljs-attr">gas</span>: receipt.<span class="hljs-property">gasUsed</span>.<span class="hljs-title function_">toString</span>(), <span class="hljs-comment">// 实际消耗的 gas</span><br>  事件列表: receipt.<span class="hljs-property">logs</span>, <span class="hljs-comment">// 合约触发的事件（如 Transfer、Minted）</span><br>  状态: receipt.<span class="hljs-property">status</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&quot;成功&quot;</span> : <span class="hljs-string">&quot;失败&quot;</span> <span class="hljs-comment">// status=1 表示交易成功</span><br>&#125;);<br></code></pre></div></td></tr></table></figure>


<h2 id="四、完整实战案例（复刻你的-NFT-铸造示例）"><a href="#四、完整实战案例（复刻你的-NFT-铸造示例）" class="headerlink" title="四、完整实战案例（复刻你的 NFT 铸造示例）"></a>四、完整实战案例（复刻你的 NFT 铸造示例）</h2><p>把上面的模块串起来，写一个可直接运行的脚本（<code>mint.js</code>）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; ethers &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;ethers&quot;</span>);<br><br><span class="hljs-comment">// 配置信息（替换成自己的）</span><br><span class="hljs-keyword">const</span> config = &#123;<br>  <span class="hljs-attr">rpcUrl</span>: <span class="hljs-string">&quot;https://eth-sepolia.g.alchemy.com/v2/你的API密钥&quot;</span>,<br>  <span class="hljs-attr">privateKey</span>: <span class="hljs-string">&quot;你的测试账户私钥&quot;</span>,<br>  <span class="hljs-attr">contractAddress</span>: <span class="hljs-string">&quot;0x123...&quot;</span>, <span class="hljs-comment">// 你的测试网 NFT 合约地址</span><br>  <span class="hljs-attr">tokenURI</span>: <span class="hljs-string">&quot;ipfs://QmXXX...&quot;</span> <span class="hljs-comment">// 你的 NFT 元数据地址</span><br>&#125;;<br><br><span class="hljs-comment">// 合约 ABI（只保留需要的函数，精简体积）</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MyNFTABI</span> = [<br>  <span class="hljs-string">&quot;function mint(string calldata tokenURI) external returns (uint256)&quot;</span>,<br>  <span class="hljs-string">&quot;event Minted(address indexed minter, uint256 indexed tokenId)&quot;</span> <span class="hljs-comment">// 合约定义的事件（需和合约一致）</span><br>];<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// 1. 连接链 + 创建签名者</span><br>    <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">JsonRpcProvider</span>(config.<span class="hljs-property">rpcUrl</span>);<br>    <span class="hljs-keyword">const</span> signer = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Wallet</span>(config.<span class="hljs-property">privateKey</span>, provider);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;当前钱包地址：&quot;</span>, <span class="hljs-keyword">await</span> signer.<span class="hljs-title function_">getAddress</span>());<br><br>    <span class="hljs-comment">// 2. 绑定合约</span><br>    <span class="hljs-keyword">const</span> nftContract = <span class="hljs-keyword">new</span> ethers.<span class="hljs-title class_">Contract</span>(config.<span class="hljs-property">contractAddress</span>, <span class="hljs-title class_">MyNFTABI</span>, signer);<br><br>    <span class="hljs-comment">// 3. 发送铸造交易</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;开始铸造 NFT...&quot;</span>);<br>    <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> nftContract.<span class="hljs-title function_">mint</span>(config.<span class="hljs-property">tokenURI</span>, &#123; <span class="hljs-attr">gasLimit</span>: <span class="hljs-number">300000</span> &#125;);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;交易哈希：&quot;</span>, tx.<span class="hljs-property">hash</span>);<br><br>    <span class="hljs-comment">// 4. 等待上链并输出结果</span><br>    <span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> tx.<span class="hljs-title function_">wait</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;NFT 铸造成功！&quot;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;区块号：&quot;</span>, receipt.<span class="hljs-property">blockNumber</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;铸造的 NFT ID：&quot;</span>, receipt.<span class="hljs-property">logs</span>[<span class="hljs-number">0</span>].<span class="hljs-property">args</span>.<span class="hljs-property">tokenId</span>.<span class="hljs-title function_">toString</span>());<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;铸造失败：&quot;</span>, error.<span class="hljs-property">message</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-title function_">main</span>();<br></code></pre></div></td></tr></table></figure>

<p>运行脚本：<code>node mint.js</code>，成功后可在 <a target="_blank" rel="noopener" href="https://sepolia.etherscan.io/">Sepolia Etherscan</a> 输入交易哈希查看详情。</p>
<h2 id="五、避坑指南（新手必看）"><a href="#五、避坑指南（新手必看）" class="headerlink" title="五、避坑指南（新手必看）"></a>五、避坑指南（新手必看）</h2><ol>
<li><strong>私钥安全</strong>：绝对不能把私钥硬编码到代码里！生产环境用：<ul>
<li>前端：通过 <code>BrowserProvider</code> 对接 MetaMask（用户自己签名，不暴露私钥）</li>
<li>后端：用环境变量（<code>process.env.PRIVATE_KEY</code>），配合 <code>.env</code> 文件（安装 <code>dotenv</code> 库）</li>
</ul>
</li>
<li><strong>ABI 错误</strong>：ABI 必须和合约一致，缺少函数定义或参数类型错误会直接报错（建议从 Hardhat 编译产物中导入，避免手动写错）</li>
<li><strong>gas 问题</strong>：<ul>
<li>交易失败提示 <code>out of gas</code>：提高 <code>gasLimit</code>（比如从 200000 调到 300000）</li>
<li>gas 价格太高：用 <code>provider.getGasPrice()</code> 获取当前链上平均价格，动态设置：<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> gasPrice = <span class="hljs-keyword">await</span> provider.<span class="hljs-title function_">getGasPrice</span>();<br><span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> nftContract.<span class="hljs-title function_">mint</span>(tokenURI, &#123; gasPrice &#125;);<br></code></pre></div></td></tr></table></figure></li>
</ul>
</li>
<li><strong>节点连接失败</strong>：检查 RPC 地址是否正确（Alchemy 密钥是否有效），测试网是否正常（可换 Infura 节点备用）</li>
<li><strong>合约权限</strong>：部分写函数（如 <code>mint</code>）可能限制仅管理员调用，确保你的签名者地址有权限</li>
</ol>
<h2 id="六、进阶学习方向（按需拓展）"><a href="#六、进阶学习方向（按需拓展）" class="headerlink" title="六、进阶学习方向（按需拓展）"></a>六、进阶学习方向（按需拓展）</h2><p>掌握基础流程后，可补充这些实用技能：</p>
<ol>
<li><strong>事件监听</strong>：实时监听合约事件（如 NFT 转让、铸造）：<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">nftContract.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;Minted&quot;</span>, <span class="hljs-function">(<span class="hljs-params">minter, tokenId</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`新 NFT 铸造：地址 <span class="hljs-subst">$&#123;minter&#125;</span>，ID <span class="hljs-subst">$&#123;tokenId&#125;</span>`</span>);<br>&#125;);<br></code></pre></div></td></tr></table></figure></li>
<li><strong>批量交易</strong>：用 <code>signer.sendTransaction()</code> 批量发送交易，或用 <code>Promise.all</code> 批量调用合约</li>
<li><strong>合约部署</strong>：用 Ethers.js 部署合约（配合 Hardhat 更简单）</li>
<li><strong>前端集成</strong>：对接 MetaMask（浏览器环境），实现“用户点击按钮铸造 NFT”</li>
<li><strong>错误处理</strong>：捕获交易失败（如余额不足、合约 revert），给用户友好提示</li>
</ol>
<h2 id="七、推荐学习资源（高效入门）"><a href="#七、推荐学习资源（高效入门）" class="headerlink" title="七、推荐学习资源（高效入门）"></a>七、推荐学习资源（高效入门）</h2><ol>
<li><strong>官方文档（首选）</strong>：Ethers.js v6 文档（简洁清晰，示例到位）<br><a target="_blank" rel="noopener" href="https://docs.ethers.org/v6/">https://docs.ethers.org/v6/</a></li>
<li><strong>实战教程</strong>：Alchemy 文档（含 Ethers.js 合约交互、NFT 铸造完整案例）<br><a target="_blank" rel="noopener" href="https://docs.alchemy.com/docs/ethers-js-tutorial">https://docs.alchemy.com/docs/ethers-js-tutorial</a></li>
<li><strong>代码示例</strong>：Ethers.js GitHub 示例库（覆盖所有核心功能）<br><a target="_blank" rel="noopener" href="https://github.com/ethers-io/ethers.js/tree/main/examples">https://github.com/ethers-io/ethers.js/tree/main/examples</a></li>
<li><strong>问题排查</strong>：Stack Overflow（关键词 <code>ethers.js</code>）、Ethers.js Discord 社区</li>
</ol>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><p>Ethers.js 学习的核心是「流程固化 + 实操验证」：  </p>
<ol>
<li>先记住「Provider（连链）→ Signer（签名）→ Contract（操作合约）」的固定流程；  </li>
<li>用测试网反复练“读函数→写函数→交易回执”，熟悉参数和错误；  </li>
<li>重点关注私钥安全、gas 控制、事件提取这 3 个实战高频点。</li>
</ol>
<p>按这个路径，1-2 天就能熟练写出合约交互代码，多换几个合约（比如 ERC20 转账、NFT 转让）练习，很快就能掌握！</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Web3/">Web3</a>
                    
                  </div>
                
              </div>
              
                
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/12/03/60237.html">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">javascript4</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/12/03/59853.html">
                        <span class="hidden-mobile">javascript2</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


            

                
                  <a id="scroll-top-button" href="#" role="button">
                    <i class="iconfont icon-arrowup" aria-hidden="true"></i>
                  </a>
                  

                    

                          
      </main>

      <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://whale3070.github.io/" target="_blank" rel="nofollow noopener"><span>Whale3070</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->




  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>





  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
  <script src="/pagefind/pagefind-ui.js"></script>
  <style>
    /* 搜索框配色适配 */
    #search { margin-top: 2rem; }
    [data-user-color-scheme='dark'] .pagefind-ui {
      --pagefind-ui-primary: #eeeeee;
      --pagefind-ui-text: #eeeeee;
      --pagefind-ui-background: #151515;
      --pagefind-ui-border: #333;
    }
  </style>
    </body>

  </html>