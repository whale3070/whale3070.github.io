

  <!DOCTYPE html>
  <html lang="zh-CN" data-default-color-scheme=&#34;dark&#34; >
  <style>
    .text1
    {
    text-shadow: 0px 0px 2px #f2f3f2;
    }
    </style>

  <script>
    // 强制内网 IP 识别为安全上下文
    if (window.location.hostname !== 'localhost' && window.location.protocol === 'http:') {
        // 尝试手动映射 crypto 属性
        if (!window.crypto.subtle && window.crypto.webkitSubtle) {
            window.crypto.subtle = window.crypto.webkitSubtle;
        }
    }
    
    // 终极补丁：如果还是没有 subtle，则创建一个占位符避免报错
    // 提示：这通常能解决加载报错，但如果插件强依赖原生加密，建议执行下面的“降级”预判
    if (!window.isSecureContext) {
        console.warn('当前环境非安全上下文，正在尝试兼容内网加密解密...');
    }
</script>


<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/null">
  <link rel="icon" type="image/png" href="/null">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>cryptozombies7-Truffle部署智能合约 - whale3070&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.4.0/styles/github-gist.min.css" />
    
  

  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"192.168.126.129","root":"/","version":"1.8.7","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":false,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 7.3.0"></head>


    <body>
      <header style="height: 70vh;">
        <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>InfoSec learning</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/search/">
                <i class="iconfont icon-search"></i>
                搜索
              </a>
            </li>
          
        
        
        
          
        
      </ul>
    </div>
  </div>
</nav>

          <div class="banner" id="banner" false
            style="background: url('/img/default.png') no-repeat center center;
              background-size: cover;">
              <div class="full-bg-img">
                <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
                  <div class="page-header text-center fade-in-up">
                    <span class="h2 text1" id="subtitle" title="cryptozombies7-Truffle部署智能合约">
                      
                        cryptozombies7-Truffle部署智能合约
                      
                    </span>
        
                    
                      <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2025-11-27 14:48" pubdate>
        2025年11月27日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5.7k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      63
       分钟
    </span>
  

  
  
</div>

                    
                  </div>
                    
                  </div>
                  
                </div>
              </div>
          </div>
      </header>

      <main>
        
          

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" data-pagefind-body>
            <!-- SEO header -->
            <h1 style="display: none">cryptozombies7-Truffle部署智能合约</h1>
            
            <div class="markdown-body">
              <h1 id="第1章：简介"><a href="#第1章：简介" class="headerlink" title="第1章：简介"></a><strong>第1章：简介</strong></h1><p>如果你是 CryptoZombies 的新手，强烈建议在开始本章之前先完成前六节课。请花时间熟悉编写智能合约。否则，你可能会很难跟上本节课的内容。</p>
<p><strong>缺失的一块</strong><br>如果你已经完成了之前的课程，太棒了！这意味着你几乎掌握了构建 DApp 的艺术。</p>
<p>但是，还有一个重要的部分尚未完成。</p>
<p>没错……你还需要学习如何部署智能合约。</p>
<p>如果你有前端开发的背景，可能已经非常熟悉像 Webpack、Gulp 或 Browserify 这样的工具，它们让开发者的生活变得更轻松。</p>
<p>但是，Solidity 开发者使用什么工具呢？</p>
<p><strong>Truffle</strong><br>Truffle 是最受欢迎的区块链开发框架，原因很简单——它具有许多有用的功能：</p>
<ul>
<li>简单的智能合约编译</li>
<li>自动生成 ABI</li>
<li>集成的智能合约测试——甚至支持 Mocha 和 Chai！</li>
<li>支持多个网络——代码可以部署到 Rinkeby、Ethereum，甚至 Loom。我们稍后会演示这个😉</li>
</ul>
<p>只要你的计算机上已经安装了 npm 和 node，我们将教你如何安装 Truffle，并将其设置为全局可用。</p>
<p><strong>实践测试</strong><br>我们将从基础开始。打开一个新的终端窗口，创建一个名为 CryptoZombies 的目录，并进入该目录。</p>
<p>现在，让我们安装 Truffle 并使其全局可用。</p>
<p>注意：这是如何使用 npm 安装一个包并使其全局可用的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npm install package_name -g<br></code></pre></div></td></tr></table></figure>


<h1 id="truffle-fountry-hardhat有什么区别"><a href="#truffle-fountry-hardhat有什么区别" class="headerlink" title="truffle fountry hardhat有什么区别?"></a>truffle fountry hardhat有什么区别?</h1><p>Truffle、Foundry 和 Hardhat 都是用于开发和测试 Ethereum 智能合约的开发框架，但它们在设计理念、功能和使用场景上有所不同。下面是它们的主要区别：</p>
<h3 id="1-Truffle"><a href="#1-Truffle" class="headerlink" title="1. Truffle"></a>1. <strong>Truffle</strong></h3><p><strong>Truffle</strong> 是一个非常成熟和广泛使用的 Ethereum 开发框架，提供了完整的开发工具链。</p>
<h4 id="主要特点："><a href="#主要特点：" class="headerlink" title="主要特点："></a>主要特点：</h4><ul>
<li><strong>合约编译和部署</strong>：Truffle 提供了一整套从编译到部署的工具链。你可以方便地编写、测试和部署智能合约。</li>
<li><strong>测试框架</strong>：集成了 Mocha 和 Chai，支持自动化单元测试，使用 JavaScript 编写测试。</li>
<li><strong>网络管理</strong>：内置了与 Ethereum 网络交互的功能，支持本地和远程的区块链网络。</li>
<li><strong>脚本化迁移</strong>：通过迁移文件来管理合约的部署，支持版本控制。</li>
<li><strong>Truffle Console</strong>：一个交互式的 JavaScript 控制台，可以直接与部署在区块链上的合约进行交互。</li>
<li><strong>集成 GANACHE</strong>：集成了 GANACHE（一个本地 Ethereum 仿真网络），允许开发人员快速在本地进行开发和测试。</li>
</ul>
<h4 id="优势："><a href="#优势：" class="headerlink" title="优势："></a>优势：</h4><ul>
<li>生态系统成熟，文档丰富。</li>
<li>强大的集成测试支持。</li>
<li>适合大规模的项目，尤其是那些涉及多个合约的复杂项目。</li>
</ul>
<h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4><ul>
<li>启动速度较慢，尤其是在大规模合约部署时。</li>
<li>对比其它工具，构建过程可能稍显笨重。</li>
</ul>
<h3 id="2-Foundry"><a href="#2-Foundry" class="headerlink" title="2. Foundry"></a>2. <strong>Foundry</strong></h3><p><strong>Foundry</strong> 是一个新兴的智能合约开发框架，设计为轻量级和快速的工具。它主要侧重于高性能的合约开发和测试。</p>
<h4 id="主要特点：-1"><a href="#主要特点：-1" class="headerlink" title="主要特点："></a>主要特点：</h4><ul>
<li><strong>Rust 编写</strong>：Foundry 使用 Rust 编写，具有比 Truffle 和 Hardhat 更高的性能，尤其是在测试和合约编译方面。</li>
<li><strong>测试</strong>：支持用 Solidity 编写的测试，提供了高效的运行时和异步执行环境。可以通过 <code>forge test</code> 来运行测试。</li>
<li><strong>编译</strong>：Foundry 使用 <code>forge</code> 工具进行高效的智能合约编译。它的编译速度非常快。</li>
<li><strong>链上工具</strong>：Foundry 提供了一些高级功能，如链上调试和与链交互的能力。</li>
<li><strong>无依赖</strong>：Foundry 依赖极少，旨在提供轻量的开发体验。</li>
</ul>
<h4 id="优势：-1"><a href="#优势：-1" class="headerlink" title="优势："></a>优势：</h4><ul>
<li><strong>速度</strong>：相比 Truffle 和 Hardhat，Foundry 提供了显著更高的速度，尤其是在合约编译和测试方面。</li>
<li><strong>轻量级</strong>：工具和框架更简洁，且没有太多依赖。</li>
<li><strong>性能优化</strong>：由于使用 Rust 编写，Foundry 具有更高的性能，适合需要快速反馈的开发流程。</li>
</ul>
<h4 id="缺点：-1"><a href="#缺点：-1" class="headerlink" title="缺点："></a>缺点：</h4><ul>
<li><strong>较新的工具</strong>：相比 Truffle 和 Hardhat，Foundry 较新，社区和文档可能不如前者成熟。</li>
<li><strong>较少的功能集成</strong>：虽然 Foundry 很强大，但它不如 Truffle 和 Hardhat 在多功能集成方面完备。</li>
</ul>
<h3 id="3-Hardhat"><a href="#3-Hardhat" class="headerlink" title="3. Hardhat"></a>3. <strong>Hardhat</strong></h3><p><strong>Hardhat</strong> 是一个快速的开发框架，专为以太坊智能合约开发设计，注重开发者体验和性能。</p>
<h4 id="主要特点：-2"><a href="#主要特点：-2" class="headerlink" title="主要特点："></a>主要特点：</h4><ul>
<li><strong>本地节点支持</strong>：Hardhat 提供一个本地 Ethereum 节点，可以在本地进行开发和测试。</li>
<li><strong>强大的调试功能</strong>：Hardhat 提供了强大的调试功能，可以在发生合约错误时提供详细的堆栈跟踪信息。</li>
<li><strong>易于集成</strong>：Hardhat 可以与其它工具如 Truffle 和 Web3.js 集成，支持使用 Solidity 编写的合约和测试。</li>
<li><strong>插件支持</strong>：Hardhat 提供了丰富的插件支持，允许开发者通过插件扩展功能（例如，部署插件、Ethers.js 插件等）。</li>
<li><strong>集成测试框架</strong>：支持 Mocha 和 Chai 的集成测试框架，允许用 JavaScript 编写测试。</li>
<li><strong>Solidity 版本管理</strong>：Hardhat 可以轻松地切换和管理不同版本的 Solidity 编译器。</li>
</ul>
<h4 id="优势：-2"><a href="#优势：-2" class="headerlink" title="优势："></a>优势：</h4><ul>
<li><strong>调试工具</strong>：Hardhat 的调试工具非常强大，能够详细显示错误和调试信息。</li>
<li><strong>插件系统</strong>：支持丰富的插件扩展，可以集成许多额外功能，如 Ethers.js、部署、测试等。</li>
<li><strong>社区活跃</strong>：作为广泛使用的工具，Hardhat 有着非常活跃的社区和丰富的文档支持。</li>
</ul>
<h4 id="缺点：-2"><a href="#缺点：-2" class="headerlink" title="缺点："></a>缺点：</h4><ul>
<li><strong>性能</strong>：虽然 Hardhat 性能较好，但与 Foundry 相比，它的编译速度可能较慢。</li>
<li><strong>相对较新的工具</strong>：虽然 Hardhat 在业内已被广泛使用，但它相对较新，某些高级功能的稳定性和成熟度可能还在发展中。</li>
</ul>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ul>
<li><strong>Truffle</strong> 适合需要一个完整工具链的开发者，特别是那些处理多个合约和需要强大集成测试功能的项目。</li>
<li><strong>Foundry</strong> 提供了更高的性能，适合快速开发和测试的项目，特别是当速度和轻量级是首要需求时。</li>
<li><strong>Hardhat</strong> 提供了强大的调试工具和插件支持，适合希望灵活自定义开发环境并快速调试的开发者。</li>
</ul>
<p>如果你希望高效的开发并且注重性能，<strong>Foundry</strong> 可能是最佳选择。如果你希望更成熟的工具和广泛的社区支持，<strong>Truffle</strong> 或 <strong>Hardhat</strong> 可能是更合适的选择。</p>
<h1 id="第二章：开始使用-Truffle"><a href="#第二章：开始使用-Truffle" class="headerlink" title="第二章：开始使用 Truffle"></a>第二章：开始使用 Truffle</h1><p>现在我们已经安装了 Truffle，是时候通过运行 <code>truffle init</code> 来初始化我们的新项目了。这个命令的作用是创建一组文件夹和配置文件，目录结构如下：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs x86asm">├── contracts<br>    ├── Migrations<span class="hljs-number">.</span>sol<br>├── migrations<br>    ├── 1_initial_migration<span class="hljs-number">.</span><span class="hljs-keyword">js</span><br>└── <span class="hljs-keyword">test</span><br>truffle-config<span class="hljs-number">.</span><span class="hljs-keyword">js</span><br>truffle<span class="hljs-number">.</span><span class="hljs-keyword">js</span><br></code></pre></div></td></tr></table></figure>

<p>合约、迁移、测试… 看起来有点复杂 😟</p>
<p>别担心，学习使用 Truffle 不会让你头疼。本章将带你了解 Truffle 的默认项目结构，一旦你熟悉了 Truffle，部署智能合约将变得非常简单。</p>
<h3 id="Truffle-的默认目录结构"><a href="#Truffle-的默认目录结构" class="headerlink" title="Truffle 的默认目录结构"></a>Truffle 的默认目录结构</h3><p>在 <code>CryptoZombies</code> 目录中运行 <code>truffle init</code> 命令后，会创建几个目录和一些 JavaScript 和 Solidity 文件。让我们详细看看：</p>
<ul>
<li><p><strong>contracts</strong>：这是 Truffle 默认会查找所有智能合约的地方。为了让代码更加有序，我们甚至可以创建嵌套文件夹，例如 <code>contracts/tokens</code>。是不是很方便？😉</p>
<p><strong>注意</strong>：<code>truffle init</code> 命令会自动创建一个名为 <code>Migrations.sol</code> 的合约文件和相应的迁移文件，稍后我们会讲解它们。</p>
</li>
<li><p><strong>migrations</strong>：迁移是一个 JavaScript 文件，告诉 Truffle 如何部署智能合约。</p>
</li>
<li><p><strong>test</strong>：这里是放置单元测试的地方，测试可以是 JavaScript 或 Solidity 文件。记住，一旦合约部署到区块链上，它就不能再修改了，因此在部署之前，测试智能合约是至关重要的。</p>
</li>
<li><p><strong>truffle.js 和 truffle-config.js</strong>：这两个配置文件用于存储部署时的网络设置。Truffle 需要两个配置文件，因为在 Windows 系统上，<code>truffle.js</code> 和 <code>truffle.exe</code> 在同一个文件夹中可能会产生冲突。简单来说，如果你使用 Windows 系统，建议删除 <code>truffle.js</code> 并使用 <code>truffle-config.js</code> 作为默认配置文件。你可以查看 Truffle 的官方文档，进一步了解这部分内容。</p>
</li>
</ul>
<h3 id="为什么要使用这个目录结构？我不习惯，它看起来很复杂…"><a href="#为什么要使用这个目录结构？我不习惯，它看起来很复杂…" class="headerlink" title="为什么要使用这个目录结构？我不习惯，它看起来很复杂…"></a>为什么要使用这个目录结构？我不习惯，它看起来很复杂…</h3><p>好吧，这里有一些理由。首先，如果你更改这些文件夹的名称，Truffle 可能不会按预期工作。</p>
<p>其次，遵循这种约定可以使其他开发者轻松理解你的项目结构。简而言之，使用标准的文件夹结构和代码约定，未来如果你扩展或更换团队，将会更加容易。</p>
<h3 id="truffle-hdwallet-provider"><a href="#truffle-hdwallet-provider" class="headerlink" title="truffle-hdwallet-provider"></a>truffle-hdwallet-provider</h3><p>在本课中，我们将使用 Infura 将我们的代码部署到 Ethereum。通过这种方式，我们可以运行应用程序，而无需自己设置 Ethereum 节点或钱包。然而，为了保证安全，Infura 不会管理私钥，这意味着它不能代表我们签署交易。由于部署智能合约需要 Truffle 来签署交易，我们需要一个名为 <code>truffle-hdwallet-provider</code> 的工具，它的唯一作用是处理交易签名。</p>
<p><strong>注意</strong>：也许你会问，为什么我们没有在前一章就使用以下命令安装 <code>truffle-hdwallet-provider</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npm install truffle truffle-hdwallet-provider<br></code></pre></div></td></tr></table></figure>

<p>原因是，<code>truffle init</code> 命令期望找到一个空目录。如果目录中已经有文件，它会报错。因此，我们需要按照正确的顺序操作，先运行 <code>truffle init</code>，然后再安装 <code>truffle-hdwallet-provider</code>。</p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><ol>
<li><p>运行 <code>truffle init</code>。该命令将生成我们讨论过的目录结构。</p>
</li>
<li><p>运行 <code>npm install truffle-hdwallet-provider</code>。</p>
</li>
</ol>
<h1 id="Infura是什么"><a href="#Infura是什么" class="headerlink" title="Infura是什么"></a>Infura是什么</h1><p><strong>Infura</strong> 是一个基于云的服务平台，提供了通过 API 访问以太坊（Ethereum）和其他区块链网络的基础设施。它为开发者提供了一个高可用性、可扩展的接口，帮助他们与区块链进行交互，而无需自己部署和维护节点。</p>
<h3 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h3><ol>
<li><p><strong>以太坊节点访问</strong>：Infura 提供了一个公共的以太坊节点，开发者无需自己搭建和维护节点，就可以通过 Infura 的 API 访问以太坊网络。这使得开发者可以轻松地查询区块链状态、发送交易、调用智能合约等。</p>
</li>
<li><p><strong>高可用性和可扩展性</strong>：由于 Infura 运行在云平台上，它能够处理大量的并发请求，并提供高可用的服务，这对于需要高频率与区块链交互的 DApp（去中心化应用）非常重要。</p>
</li>
<li><p><strong>支持多个区块链</strong>：除了以太坊，Infura 还支持其他区块链网络，如 IPFS（InterPlanetary File System），以及多种 Layer 2 解决方案，如 Polygon（前身为 Matic）和 Arbitrum 等。</p>
</li>
</ol>
<h3 id="为什么使用-Infura"><a href="#为什么使用-Infura" class="headerlink" title="为什么使用 Infura"></a>为什么使用 Infura</h3><ul>
<li><strong>简化开发</strong>：Infura 为开发者提供了与区块链网络交互的便利，而不需要担心节点的维护、同步和管理。</li>
<li><strong>节省资源</strong>：搭建和维护一个全节点需要大量的计算资源和存储空间，而通过 Infura，开发者可以节省这些成本。</li>
<li><strong>可靠性和扩展性</strong>：Infura 提供了一个稳定的服务，能够高效处理大量请求，适合需要高并发的应用。</li>
</ul>
<h3 id="如何使用-Infura"><a href="#如何使用-Infura" class="headerlink" title="如何使用 Infura"></a>如何使用 Infura</h3><ol>
<li><p><strong>注册 Infura 账户</strong>：你需要在 <a target="_blank" rel="noopener" href="https://infura.io/">Infura</a> 官网注册一个账户。</p>
</li>
<li><p><strong>获取 API 密钥</strong>：注册后，你可以创建一个新的项目，并获得一个 API 密钥。这个密钥用于在应用中通过 Infura 访问以太坊网络。</p>
</li>
<li><p><strong>配置 Web3.js</strong>：在你的 JavaScript 代码中，你可以使用 Web3.js 库将 Infura 作为你的 Web3 提供者来连接以太坊网络。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Web3</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;web3&#x27;</span>);<br><span class="hljs-keyword">const</span> web3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Web3</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Web3</span>.<span class="hljs-property">providers</span>.<span class="hljs-title class_">HttpProvider</span>(<span class="hljs-string">&#x27;https://mainnet.infura.io/v3/YOUR_INFURA_API_KEY&#x27;</span>));<br></code></pre></div></td></tr></table></figure>
</li>
<li><p><strong>进行区块链交互</strong>：一旦设置好 Infura，你就可以使用 Web3.js 或其他库来与以太坊进行交互，如查询区块链状态、发送交易、调用智能合约等。</p>
</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Infura 使得与区块链的交互变得更加容易、快速和高效，尤其是对于开发去中心化应用（DApp）的人来说，它提供了一个可靠的解决方案，无需自行管理区块链节点。</p>
<h1 id="第3章：编译源代码"><a href="#第3章：编译源代码" class="headerlink" title="第3章：编译源代码"></a>第3章：编译源代码</h1><p>恭喜你！现在我们已经设置了项目结构并配置了 <code>truffle-hdwallet-provider</code>，接下来让我们编译智能合约。</p>
<p><strong>为什么需要编译？</strong></p>
<p>以太坊虚拟机（EVM）不能直接理解我们写的 Solidity 源代码。因此，我们需要运行一个编译器，将我们的智能合约“翻译”成机器可读的字节码。虚拟机接着执行这些字节码，并完成智能合约所要求的操作。</p>
<p><strong>想知道字节码长什么样吗？让我们看一下：</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c"><span class="hljs-string">&quot;0x60806040526010600155600154600a0a6002556201518060035566038d7ea4c6800060085560006009556046600a55336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1...&quot;</span><br></code></pre></div></td></tr></table></figure>

<p>正如你所看到的，字节码对人类来说几乎就像是对真实僵尸一样难以理解！</p>
<h3 id="使用-Solidity-编译器"><a href="#使用-Solidity-编译器" class="headerlink" title="使用 Solidity 编译器"></a>使用 Solidity 编译器</h3><p>既然我们已经提到 Solidity 编译器，我们应该说明编译器有一些非常有用的功能。</p>
<p>假设我们想修改 <code>SafeMath</code> 中的 <code>add</code> 函数定义：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs solidity">function add(uint16 a, uint16 b) internal returns (uint16) &#123;<br>    uint16 c = a + b;<br>    assert(c &gt;= a);<br>    return c;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>如果我们编译这个函数，Solidity 编译器会抛出一个警告：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">safemath.sol:<span class="hljs-number">110</span>:<span class="hljs-number">11</span>: <span class="hljs-built_in">Warning</span>: <span class="hljs-keyword">Function</span> state mutability can be restricted <span class="hljs-keyword">to</span> pure<br>          <span class="hljs-keyword">function</span> <span class="hljs-keyword">add</span>(uint16 a, uint16 b) <span class="hljs-type">internal</span> <span class="hljs-keyword">returns</span> (uint16) &#123;<br>          ^ (Relevant source part starts here <span class="hljs-keyword">and</span> spans across multiple lines).<br></code></pre></div></td></tr></table></figure>

<p>编译器试图告诉我们，这个函数不会从区块链读取或写入数据，我们应该使用 <code>pure</code> 修饰符。</p>
<p><strong>为什么这很重要？</strong></p>
<p>将函数标记为 <code>pure</code> 或 <code>view</code> 可以节省 gas。由于这些函数不会修改区块链的状态，矿工不需要执行它们。简而言之，<code>pure</code> 和 <code>view</code> 函数可以免费调用。</p>
<h3 id="CryptoZombies-游戏"><a href="#CryptoZombies-游戏" class="headerlink" title="CryptoZombies - 游戏"></a>CryptoZombies - 游戏</h3><p>记住，我们已经将逻辑嵌入到一个名为 <code>ZombieOwnership.sol</code> 的智能合约中。</p>
<p>嗯… 对于一个游戏来说，这个名字不太合适。</p>
<p>幸运的是，这并不是问题。我们可以使用继承创建一个具有相同操作和功能的智能合约，并可以随意命名。</p>
<p>让我们创建一个名为 <code>CryptoZombies</code> 的新智能合约，继承自 <code>ZombieOwnership.sol</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs solidity">pragma solidity ^0.4.24;<br><br>import &quot;./zombieownership.sol&quot;;<br><br>contract CryptoZombies is ZombieOwnership &#123;<br><br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>接下来，我们将所有智能合约复制到 <code>./contracts</code> 文件夹中。现在，项目结构应该是这样的：</p>
<figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">.<br>├── contracts<br>    ├── Migrations<span class="hljs-selector-class">.sol</span><br>    ├── CryptoZombies<span class="hljs-selector-class">.sol</span><br>    ├── erc721<span class="hljs-selector-class">.sol</span><br>    ├── ownable<span class="hljs-selector-class">.sol</span><br>    ├── safemath<span class="hljs-selector-class">.sol</span><br>    ├── zombieattack<span class="hljs-selector-class">.sol</span><br>    ├── zombiefactory<span class="hljs-selector-class">.sol</span><br>    ├── zombiefeeding<span class="hljs-selector-class">.sol</span><br>    ├── zombiehelper<span class="hljs-selector-class">.sol</span><br>    ├── zombieownership<span class="hljs-selector-class">.sol</span><br>├── migrations<br>└── test<br></code></pre></div></td></tr></table></figure>

<p>一切都已正确设置。接下来，我们来编译我们的项目。</p>
<h3 id="动手实践："><a href="#动手实践：" class="headerlink" title="动手实践："></a>动手实践：</h3><p>执行 <code>truffle compile</code> 命令。此命令将生成构建产物并将其放置在 <code>./build/contracts</code> 目录下。</p>
<p><strong>注意：</strong> 构建产物包括智能合约的“字节码”版本、ABI 以及一些 Truffle 用于正确部署代码的内部数据。避免编辑这些文件，否则 Truffle 可能会停止正常工作。</p>
<h1 id="第4章：迁移"><a href="#第4章：迁移" class="headerlink" title="第4章：迁移"></a>第4章：迁移</h1><p>通常在这一步，部署到以太坊主网之前，你需要先在本地测试智能合约。可以使用一款名为 Ganache 的工具来实现，它会搭建一个本地以太坊测试网络。</p>
<p>不过，测试虽然至关重要，但完整讲解需要一整节课的篇幅 —— 因此本课程我们将专注于部署流程。如果你有兴趣深入学习测试相关内容，推荐参考我们的专属课程《使用 Truffle 测试智能合约》（Testing Smart Contracts with Truffle）。</p>
<p>要向以太坊网络部署合约，我们需要创建一种名为 “迁移脚本”（migration）的文件。</p>
<p>迁移脚本是一类 JavaScript 文件，其作用是协助 Truffle 将合约代码部署到以太坊网络。需要注意的是，执行truffle init命令时会自动生成一个特殊合约Migrations.sol，该合约用于跟踪你对代码所做的所有变更。其工作原理是将变更历史记录存储在链上，从而确保同一版本的代码不会被重复部署。</p>
<h2 id="创建新的迁移"><a href="#创建新的迁移" class="headerlink" title="创建新的迁移"></a>创建新的迁移</h2><p>我们将从 Truffle 已经为我们创建的文件 .&#x2F;contracts&#x2F;1_initial_migration.js 开始。让我们看看里面的内容：</p>
<figure class="highlight abnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs abnf">var Migrations <span class="hljs-operator">=</span> artifacts.require(<span class="hljs-string">&quot;./Migrations.sol&quot;</span>)<span class="hljs-comment">;</span><br>module.exports <span class="hljs-operator">=</span> function(deployer) &#123;<br>  deployer.deploy(Migrations)<span class="hljs-comment">;</span><br>&#125;<span class="hljs-comment">;</span><br></code></pre></div></td></tr></table></figure>

<p>非常简单，对吧？</p>
<p>首先，脚本告诉 Truffle，我们希望与 Migrations 合约进行交互。</p>
<p>接下来，它导出一个函数，该函数接受一个名为 deployer 的对象作为参数。这个对象充当了你（开发者）和 Truffle 部署引擎之间的接口。尽管 deployer 提供了许多有用的功能，但在本节课的范围内我们不会使用它们。如果你完成本节课后有兴趣了解更多，可以查看 Truffle 的文档，深入了解 Truffle 的其他功能。</p>
<p>为了准备部署，我们已经创建了一个新的文件 .&#x2F;contracts&#x2F;2_crypto_zombies.js，并将 .&#x2F;contracts&#x2F;1_initial_migration.js 中的内容复制粘贴到了其中。</p>
<h2 id="实践测试"><a href="#实践测试" class="headerlink" title="实践测试"></a>实践测试</h2><p>修改 .&#x2F;contracts&#x2F;2_crypto_zombies.js 文件，使其内容如下：</p>
<figure class="highlight abnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs abnf">var CryptoZombies <span class="hljs-operator">=</span> artifacts.require(<span class="hljs-string">&quot;./CryptoZombies.sol&quot;</span>)<span class="hljs-comment">;</span><br>module.exports <span class="hljs-operator">=</span> function(deployer) &#123;<br>  deployer.deploy(CryptoZombies)<span class="hljs-comment">;</span><br>&#125;<span class="hljs-comment">;</span><br></code></pre></div></td></tr></table></figure>

<p><strong>第5章：配置文件</strong><br>太棒了！你已经成功编译了源代码并创建了迁移文件。</p>
<p>在我们部署之前，还有一件事需要做。我们需要编辑配置文件，告诉 Truffle 我们希望部署到哪些网络。</p>
<p>等一下，我以为只有一个以太坊网络。这里我错过了什么吗？</p>
<p><strong>以太坊测试网络</strong><br>多个公共的以太坊测试网络允许你在将合约部署到主网之前免费测试它们（记住，一旦你将合约部署到主网，就无法再修改它）。这些测试网络使用与主网不同的共识算法（通常是 PoA），而且以太币是免费的，目的是鼓励进行彻底的测试。</p>
<p>在本节课中，我们将使用由以太坊基金会创建的公共测试网络 Rinkeby。</p>
<h1 id="第5章：配置文件"><a href="#第5章：配置文件" class="headerlink" title="第5章：配置文件"></a><strong>第5章：配置文件</strong></h1><p>太棒了！你已经成功编译了源代码并创建了迁移文件。</p>
<p>在我们部署之前，还有一件事需要做。我们需要编辑配置文件，告诉 Truffle 我们希望部署到哪些网络。</p>
<p>等一下，我以为只有一个以太坊网络。这里我错过了什么吗？</p>
<h2 id="以太坊测试网络"><a href="#以太坊测试网络" class="headerlink" title="以太坊测试网络"></a><strong>以太坊测试网络</strong></h2><p>多个公共的以太坊测试网络允许你在将合约部署到主网之前免费测试它们（记住，一旦你将合约部署到主网，就无法再修改它）。这些测试网络使用与主网不同的共识算法（通常是 PoA），而且以太币是免费的，目的是鼓励进行彻底的测试。</p>
<p>在本节课中，我们将使用由以太坊基金会创建的公共测试网络 Rinkeby。</p>
<h2 id="truffle-js-配置文件"><a href="#truffle-js-配置文件" class="headerlink" title="truffle.js 配置文件"></a><strong>truffle.js 配置文件</strong></h2><p>现在，让我们来看一下默认的 Truffle 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ <span class="hljs-built_in">cat</span> truffle.js<br>/*<br> * NB: since truffle-hdwallet-provider 0.0.5 you must wrap HDWallet providers <span class="hljs-keyword">in</span> a<br> * <span class="hljs-keyword">function</span> when declaring them. Failure to <span class="hljs-keyword">do</span> so will cause commands to hang. ex:<br> *<br> * mainnet: &#123;<br> *     provider: <span class="hljs-function"><span class="hljs-title">function</span></span>() &#123;<br> *       <span class="hljs-built_in">return</span> new HDWalletProvider(mnemonic, <span class="hljs-string">&#x27;https://mainnet.infura.io/&lt;infura-key&gt;&#x27;</span>)<br> *     &#125;,<br> *     network_id: <span class="hljs-string">&#x27;1&#x27;</span>,<br> *     gas: 4500000,<br> *     gasPrice: 10000000000,<br> *   &#125;,<br> */<br></code></pre></div></td></tr></table></figure>

<p>它只是一个空壳。因此，我们需要更新这个文件，以便能够将合约部署到 Rinkeby 和以太坊主网。</p>
<h2 id="Truffle-的-HD-钱包提供者"><a href="#Truffle-的-HD-钱包提供者" class="headerlink" title="Truffle 的 HD 钱包提供者"></a><strong>Truffle 的 HD 钱包提供者</strong></h2><p>还记得第二章吗？</p>
<p>我们要求你安装一个额外的包，叫做 <code>truffle-hdwallet-provider</code>，它帮助 Truffle 签署交易。</p>
<p>现在，我们想编辑配置文件以使用 <code>HDWalletProvider</code>。为了使它工作，我们将在文件的顶部添加一行代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HDWalletProvider</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;truffle-hdwallet-provider&quot;</span>);<br></code></pre></div></td></tr></table></figure>

<p>接下来，我们将创建一个新变量来存储我们的助记词（mnemonic）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> mnemonic = <span class="hljs-string">&quot;onions carrots beans ...&quot;</span>;<br></code></pre></div></td></tr></table></figure>

<p>请注意，我们不建议将像助记词或私钥这样的秘密信息存储在配置文件中。</p>
<p>…为什么呢？</p>
<p>配置文件通常会被推送到 GitHub，任何人都可以看到它们，这样就容易遭受攻击 😱！为了避免泄露你的助记词（或私钥！），你应该从文件中读取它，并将该文件添加到 <code>.gitignore</code> 中。稍后我们会向你展示如何做到这一点。</p>
<p>为了简化起见，在这种情况下，我们将助记词复制并存储在一个变量中。</p>
<h2 id="为-Rinkeby-和以太坊主网设置-Truffle"><a href="#为-Rinkeby-和以太坊主网设置-Truffle" class="headerlink" title="为 Rinkeby 和以太坊主网设置 Truffle"></a><strong>为 Rinkeby 和以太坊主网设置 Truffle</strong></h2><p>接下来，为了确保 Truffle “知道” 我们希望部署的网络，我们需要创建两个独立的对象——一个用于 Rinkeby，另一个用于以太坊主网：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-attr">networks</span>: &#123;<br>  <span class="hljs-comment">// 主网配置</span><br>  <span class="hljs-attr">mainnet</span>: &#123;<br>    <span class="hljs-attr">provider</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-comment">// 设置提供者为 Infura 主网地址和 Token</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HDWalletProvider</span>(mnemonic, <span class="hljs-string">&quot;https://mainnet.infura.io/v3/YOUR_TOKEN&quot;</span>)<br>    &#125;,<br>    <span class="hljs-attr">network_id</span>: <span class="hljs-string">&quot;1&quot;</span><br>  &#125;,<br>  <span class="hljs-comment">// Rinkeby 网络配置</span><br>  <span class="hljs-attr">rinkeby</span>: &#123;<br>    <span class="hljs-comment">// 设置提供者的特殊函数</span><br>    <span class="hljs-attr">provider</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-comment">// 设置提供者为 Infura Rinkeby 地址和 Token</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HDWalletProvider</span>(mnemonic, <span class="hljs-string">&quot;https://rinkeby.infura.io/v3/YOUR_TOKEN&quot;</span>)<br>    &#125;,<br>    <span class="hljs-comment">// Rinkeby 的 network_id 是 4</span><br>    <span class="hljs-attr">network_id</span>: <span class="hljs-number">4</span><br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p><strong>注意</strong>：<code>provider</code> 的值被包装在一个函数中，这确保了它不会在不需要时初始化。</p>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a><strong>总结</strong></h2><p>现在，让我们将这些部分组合起来，看看我们的配置文件应该是什么样子的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 初始化 HDWalletProvider</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HDWalletProvider</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;truffle-hdwallet-provider&quot;</span>);<br><br><span class="hljs-comment">// 在这里设置你自己的助记词</span><br><span class="hljs-keyword">const</span> mnemonic = <span class="hljs-string">&quot;YOUR_MNEMONIC&quot;</span>;<br><br><span class="hljs-comment">// 模块导出，使此配置文件对 Truffle 可用</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// 包含每个网络配置的对象</span><br>  <span class="hljs-attr">networks</span>: &#123;<br>    <span class="hljs-comment">// 主网配置</span><br>    <span class="hljs-attr">mainnet</span>: &#123;<br>      <span class="hljs-attr">provider</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// 设置提供者为 Infura 主网地址和 Token</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HDWalletProvider</span>(mnemonic, <span class="hljs-string">&quot;https://mainnet.infura.io/v3/YOUR_TOKEN&quot;</span>)<br>      &#125;,<br>      <span class="hljs-attr">network_id</span>: <span class="hljs-string">&quot;1&quot;</span><br>    &#125;,<br>    <span class="hljs-comment">// Rinkeby 网络配置</span><br>    <span class="hljs-attr">rinkeby</span>: &#123;<br>      <span class="hljs-comment">// 设置提供者的特殊函数</span><br>      <span class="hljs-attr">provider</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// 设置提供者为 Infura Rinkeby 地址和 Token</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HDWalletProvider</span>(mnemonic, <span class="hljs-string">&quot;https://rinkeby.infura.io/v3/YOUR_TOKEN&quot;</span>)<br>      &#125;,<br>      <span class="hljs-comment">// Rinkeby 的 network_id 是 4</span><br>      <span class="hljs-attr">network_id</span>: <span class="hljs-number">4</span><br>    &#125;<br>  &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure>

<h2 id="实践测试-1"><a href="#实践测试-1" class="headerlink" title="实践测试"></a><strong>实践测试</strong></h2><p>我们已经为你更新了大部分配置文件。现在，让我们填写缺失的部分：</p>
<ol>
<li>在文件的顶部，添加初始化 <code>truffle-hdwallet-provider</code> 的代码行。</li>
<li>填写 Rinkeby 网络的 <code>network_id</code>。如果你不记得这个参数的值，可以查看上面的代码片段。</li>
</ol>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Web3/">Web3</a>
                    
                  </div>
                
              </div>
              
                
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/11/27/63046.html">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">cryptozombies8</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/11/27/12999.html">
                        <span class="hidden-mobile">cryptozombies6-总结、感谢与建议</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


            

                
                  <a id="scroll-top-button" href="#" role="button">
                    <i class="iconfont icon-arrowup" aria-hidden="true"></i>
                  </a>
                  

                    

                          
      </main>

      <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://whale3070.github.io/" target="_blank" rel="nofollow noopener"><span>Whale3070</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->




  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>





  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
  <script src="/pagefind/pagefind-ui.js"></script>
  <style>
    /* 搜索框配色适配 */
    #search { margin-top: 2rem; }
    [data-user-color-scheme='dark'] .pagefind-ui {
      --pagefind-ui-primary: #eeeeee;
      --pagefind-ui-text: #eeeeee;
      --pagefind-ui-background: #151515;
      --pagefind-ui-border: #333;
    }
  </style>
    </body>

  </html>